<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <title>Examples using the SDI-12 Library &raquo; TestSensorTiming.ino example | SDI-12 for Arduino2.2.0</title>
  <link rel="stylesheet" href="m-EnviroDIY+documentation.compiled.css" />

<style id="wp-emoji-styles-inline-css" type="text/css">
  img.wp-smiley,
  img.emoji {
    display: inline !important;
    border: none !important;
    box-shadow: none !important;
    height: 1em !important;
    width: 1em !important;
    margin: 0 0.07em !important;
    vertical-align: -0.1em !important;
    background: none !important;
    padding: 0 !important;
  }
</style>
<link
  rel="stylesheet"
  id="gp-parent-style-css"
  href="https://www.envirodiy.org/wp-content/themes/socialize/style.css?ver=6.5.4"
  type="text/css"
  media="all"
/>
<link
  rel="stylesheet"
  id="redux-extendify-styles-css"
  href="https://www.envirodiy.org/wp-content/themes/socialize/lib/framework/redux/assets/css/extendify-utilities.css?ver=4.4.11"
  type="text/css"
  media="all"
/>
<style id="ghostpool-style-inline-css" type="text/css">
  #gp-main-header {
    min-height: 80px;
  }
  .gp-desktop-scrolling #gp-main-header {
    min-height: 80px;
  }
  .gp-header-standard #gp-logo {
    padding: 19px 0;
  }
  .gp-desktop-scrolling.gp-header-standard #gp-logo {
    padding: 12.5px 0;
  }
  .gp-header-standard #gp-primary-main-nav .menu > li > a {
    padding: 30.5px 0;
  }
  .gp-header-standard #gp-cart-button,
  .gp-header-standard #gp-search-button,
  .gp-header-standard #gp-profile-button {
    padding: 31px 0;
  }
  .gp-desktop-scrolling.gp-header-standard #gp-primary-main-nav .menu > li > a {
    padding: 30.5px 0;
  }
  .gp-desktop-scrolling.gp-header-standard #gp-cart-button,
  .gp-desktop-scrolling.gp-header-standard #gp-search-button,
  .gp-desktop-scrolling.gp-header-standard #gp-profile-button {
    padding: 31px 0;
  }
  .gp-nav .menu > .gp-standard-menu > .sub-menu > li:hover > a {
    color: #fff;
  }
  .gp-theme li:hover .gp-primary-dropdown-icon {
    color: #fff;
  }
  .gp-theme .sub-menu li:hover .gp-secondary-dropdown-icon {
    color: #fff;
  }
  .gp-header-centered #gp-cart-button,
  .gp-header-centered #gp-search-button,
  .gp-header-centered #gp-profile-button {
    line-height: 18px;
  }
  .gp-header-standard #gp-secondary-main-nav .menu > li > a {
    padding: 31.5px 0;
  }
  .gp-desktop-scrolling.gp-header-standard #gp-secondary-main-nav .menu > li > a {
    padding: 31.5px 0;
  }
  .gp-header-centered #gp-secondary-main-nav .menu > li > a {
    line-height: 16px;
  }
  .gp-active {
    color: #000;
  }
  .gp-theme .widget.buddypress div.item-options a.selected:hover {
    color: #0579bd !important;
  }
  .gp-theme #buddypress .activity-list .activity-content blockquote a {
    color: #0579bd;
  }
  .gp-theme #buddypress .activity-list .activity-content blockquote a:hover {
    color: #000;
  }
  @media only screen and (max-width: 1082px) {
    .gp-header-standard #gp-primary-main-nav .menu > li > a {
      padding: 30.5px 0;
    }
    .gp-desktop-scrolling.gp-header-standard #gp-primary-main-nav .menu > li > a {
      padding: 30.5px 0;
    }
    .gp-header-standard #gp-cart-button,
    .gp-header-standard #gp-search-button,
    .gp-header-standard #gp-profile-button {
      padding: 31px 0;
    }
    .gp-desktop-scrolling.gp-header-standard #gp-cart-button,
    .gp-desktop-scrolling.gp-header-standard #gp-search-button,
    .gp-desktop-scrolling.gp-header-standard #gp-profile-button {
      padding: 31px 0;
    }
    .gp-header-standard #gp-secondary-main-nav .menu > li > a {
      padding: 31.5px 0;
    }
    .gp-desktop-scrolling.gp-header-standard #gp-secondary-main-nav .menu > li > a {
      padding: 31.5px 0;
    }
  }
  @media only screen and (max-width: 1023px) {
    .gp-responsive #gp-main-header {
      min-height: 80px;
    }
    .gp-responsive #gp-logo {
      padding: 26px 0;
    }
    .gp-responsive #gp-mobile-nav-button,
    .gp-responsive #gp-cart-button,
    .gp-responsive #gp-search-button,
    .gp-responsive #gp-profile-button {
      padding: 31px 0;
    }
  }
</style>
<link
  rel="stylesheet"
  id="fontawesome-css"
  href="https://www.envirodiy.org/wp-content/themes/socialize/lib/fonts/font-awesome/css/font-awesome.min.css?ver=6.5.4"
  type="text/css"
  media="all"
/>
<link
  rel="preload"
  as="style"
  href="https://fonts.googleapis.com/css?family=Roboto:300,400,500%7CRoboto%20Slab:400&#038;subset=latin&#038;display=swap&#038;ver=6.5.4"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Roboto:300,400,500%7CRoboto%20Slab:400&#038;subset=latin&#038;display=swap&#038;ver=6.5.4"
  media="print"
  onload="this.media='all'"
/>
<noscript
  ><link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:300,400,500%7CRoboto%20Slab:400&#038;subset=latin&#038;display=swap&#038;ver=6.5.4"
/></noscript>

<style type="text/css" id="wp-custom-css">
  /* Print Styles */
  @media print {
    @page {
      margin: 10mm 0;
    }
    body {
      background: white;
      color: black;
      background-image: none;
      margin: 0 !important;
      padding: 0;
    }

    body:not(.gp-full-page-page-header) .gp-page-header.gp-has-text:before,
    body:not(.gp-full-page-page-header)
      .gp-page-header.gp-has-teaser-video.gp-has-text
      .gp-video-header:before {
      background-image: none !important;
    }
    /* End print styles */

    #gp-main-header,
    #gp-small-header,
    #gp-header-area,
    #gp-footer,
    #gp-sidebar-right,
    #swrc-post-navigation,
    .hkb-subheader,
    .hkb-feedback,
    .hkb-mainpage__sidebar,
    .print-page {
      display: none;
    }
    .hkb-mainpage-wrapper {
      padding: 0 !important;
      background-image: none !important;
    }
    a#gp-to-top,
    span#toTopHover {
      display: none;
    }
    a[href]:after {
      content: ' (' attr(href) ')';
    }
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-size: 1.25em;
      page-break-after: avoid;
      page-break-inside: avoid;
    }
    .hkb-article__content h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-size: 1.25em;
      page-break-after: avoid;
      page-break-inside: avoid;
    }
    table {
      page-break-before: avoid;
      page-break-inside: avoid;
      page-break-after: avoid;
    }
    img {
      page-break-inside: avoid;
      visibility: visible;
      float: none;
    }
    blockquote,
    table,
    pre {
      page-break-inside: avoid;
    }
    ul,
    ol,
    dl {
      page-break-before: avoid;
    }
  }

  /*Gutenberg styles*/
  /*Buttons*/
  a.wp-block-button__link {
    background-color: #538122;
    border-radius: 5px;
    text-decoration: none !important;
  }
  .wp-block-button__link:hover {
    background: #365516 !important;
    color: #ffffff !important;
  }
  figcaption {
    font-style: italic;
  }
  /*End Gutenberg styles*/
  #gp-content a,
  .gp-sidebar a {
    font-weight: 400;
    text-decoration: underline;
  }
  /*BuddyPress styles*/
  /*Make activity feed content darker*/
  #buddypress .activity-list .activity-content .activity-inner p {
    color: #000000;
  }
  /*Hide activity filter on activity page*/
  #activity-filter-select.last {
    display: none !important;
  }
  /*Hide disabled BuddyPress status updates on profile page, activity page*/
  #latest-update {
    display: none;
  }
  .item-title .update {
    display: none;
  }
  /*Prevent display of comment/favorite links in activity stream. Because the comments do not get applied to posts or forum topics, they just confuse users*/
  .gp-theme #buddypress .activity-list div.activity-meta a.button,
  .gp-theme #buddypress .activity .acomment-options a,
  .gp-theme #buddypress .activity-list li.load-newest a,
  .widget.buddypress div.item-options a.selected {
    color: #26a9e0;
    display: none;
  }
  /*End BuddyPress styles*/
  /* Style print link */
  .pdfprnt-buttons > a > span {
    margin: 15px 0;
    padding-left: 0;
    text-decoration: underline;
  }
  /*Change caption text color and size*/
  .wp-caption-text {
    color: #333;
    font-size: 14px;
  }
  /*Collapse table borders */
  #gp-content table {
    border-collapse: collapse;
  }
  /*Add borders to Tableizer tables */
  .tableizer table,
  th,
  td {
    border: 1px solid #333;
  }
  /*Nested list styles*/
  #gp-content,
  .hkb-article ol ol li {
    list-style-type: lower-alpha;
  }
  #gp-content,
  .hkb-article ol ol ol li {
    list-style-type: lower-roman;
  }
  #gp-content,
  .hkb-article ul ul li {
    list-style-type: circle !important;
  }
  /* Add border */
  tr:last-child td {
    border-width: 1px;
  }
  /*bbPress*/
  /* Make forum title and description larger, remove link underlining */
  div.bbp-forum-content {
    font-size: 22px;
    line-height: 28px;
  }
  div.bbp-forum-content p {
    font-size: 16px;
    line-height: 22px;
  }
  #bbpress-forums a.bbp-forum-title {
    text-decoration: none;
  }
  .widgettitle {
    border-bottom: 3px solid #92d050 !important;
  }
  .bbp-author-name {
    font-size: 14px;
  }
  /*End bbpress styles*/
  #gp-copyright-text,
  #gp-copyright-text a:link,
  #gp-copyright-text a:visited {
    color: #fff;
    font-weight: 400;
  }
  /*WooCommerce styles*/
  bdi {
    color: #538122;
    font-weight: 500;
  }
  a.button.product_type_simple {
    display: none;
  }
  p.stock.out-of-stock {
    color: red;
    font-weight: 500;
  }
  .products li * {
    text-decoration: none !important;
  }
  div.gp-entry-cats {
    color: #333333;
  }
  span.woocommerce-Price-amount.amount {
    text-decoration: none !important;
  }
  /* Hide additional information tab */
  div.woocommerce-tabs {
    display: none !important;
  }
  /*End WooCommerce styles*/
  /*The Events Calendar*/
  #tribe-events-content a {
    color: #0579bd;
  }
  #tribe-events-content .wp-block-button__link {
    color: #ffffff;
  }
  #gp-sidebar-right
    > div
    > div.tribe-common.tribe-events.tribe-events-view.tribe-events-view--widget-events-list.tribe-events-widget {
    background-color: #fff;
    padding: 15px;
  }
  #gp-sidebar-right
    > div
    > div.tribe-common.tribe-events.tribe-events-view.tribe-events-view--widget-events-list.tribe-events-widget
    > div
    > header {
    text-transform: uppercase;
    color: #000;
    border-bottom: 3px solid #92d050;
  }
  #gp-sidebar-right
    > div
    > div.tribe-common.tribe-events.tribe-events-view.tribe-events-view--widget-events-list.tribe-events-widget
    > div
    > header
    > h3 {
    font-family: Roboto !important;
    font-size: 14px !important;
    font-weight: 500;
    padding-bottom: 11px;
  }
  #gp-sidebar-right
    > div
    > div.tribe-common.tribe-events.tribe-events-view.tribe-events-view--widget-events-list.tribe-events-widget
    > div
    > div.tribe-events-widget-events-list__view-more.tribe-common-b1.tribe-common-b2--min-medium
    > a {
    color: #26a9e0;
  }
  /*Hero Knowledge Base styles*/
  #hkb .hkb-fullwcontainer {
    max-width: var(--hkb-main-container-width);
    margin: 0 auto;
    padding: 20px 20px;
    left: 0 !important;
    right: 0 !important;
  }
  h1.hkb-article__title {
    font-weight: 300 !important;
    margin: 0 0 0.5em !important;
  }
  .hkb-categoryheader__title {
    font-weight: 300 !important;
    font-size: 40px !important;
  }
  .hkb-articlepreview__title a {
    font-weight: 300 !important;
    font-size: 28px !important;
    text-decoration: underline !important;
    color: #0579bd !important;
    font-size: 28px !important;
  }
  #hkb a {
    text-decoration: underline;
    font-weight: 400;
  }
  a.hkb_widget_exit__btn {
    background-color: #538122 !important;
    border-radius: 5px;
    text-decoration: none !important;
  }
  a.hkb_widget_exit__btn:hover {
    background: #365516 !important;
    color: #ffffff !important;
  }
  /* End Heroic KB styles */
  #swrc-post-navigation a {
    font-size: small;
  }
  p.last-updated {
    font-size: 12px;
    font-style: italic;
  }
  aside#gp-sidebar-right.gp-sidebar p.last-updated {
    display: none;
  }
  #gp-content p.last-updated {
    display: none;
  }
  #gp-content ul {
    margin: 0 0 0 20px !important;
  }
</style>
<style id="socialize-dynamic-css" title="dynamic-css" class="redux-options-output">
  #footer-image img {
    margin-top: 10px;
    margin-right: 0px;
    margin-bottom: 10px;
    margin-left: 0px;
  }
  body {
    background-color: #f1f1f1;
  }
  body:not(.gp-full-page-page-header) #gp-page-wrapper,
  body:not(.gp-full-page-page-header) #gp-small-header .gp-container,
  .gp-homepage .widgettitle.gp-fancy-title:before {
    background-color: #e8e8e8;
  }
  body:not(.gp-full-page-page-header) #gp-small-header .gp-left-triangle {
    border-left-color: #e8e8e8;
  }
  body:not(.gp-full-page-page-header) #gp-small-header .gp-right-triangle {
    border-bottom-color: #e8e8e8;
  }
  #gp-content {
    background-color: #ffffff;
  }
  body {
    font-family: Roboto, 'Arial Black', Gadget, sans-serif;
    line-height: 28px;
    font-weight: 300;
    font-style: normal;
    color: #000;
    font-size: 16px;
  }
  a {
    color: #0579bd;
  }
  a:hover {
    color: #000;
  }
  h1 {
    font-family: Roboto, Arial, Helvetica, sans-serif;
    line-height: 40px;
    font-weight: 400;
    font-style: normal;
    font-size: 36px;
  }
  h2 {
    font-family: Roboto, Arial, Helvetica, sans-serif;
    line-height: 32px;
    font-weight: 400;
    font-style: normal;
    font-size: 28px;
  }
  h3,
  #tab-description h2,
  .woocommerce #comments h2,
  .woocommerce #reviews h3,
  .woocommerce .related h2,
  .woocommerce-checkout .woocommerce h2,
  .woocommerce-checkout .woocommerce h3 {
    font-family: Roboto, Arial, Helvetica, sans-serif;
    line-height: 28px;
    font-weight: 400;
    font-style: normal;
    font-size: 24px;
  }
  h4 {
    font-family: Roboto, Arial, Helvetica, sans-serif;
    line-height: 30px;
    font-weight: 400;
    font-style: normal;
    font-size: 20px;
  }
  h5 {
    font-family: Roboto, Arial, Helvetica, sans-serif;
    line-height: 26px;
    font-weight: 400;
    font-style: normal;
    font-size: 18px;
  }
  h6 {
    font-family: Roboto, Arial, Helvetica, sans-serif;
    line-height: 24px;
    font-weight: 400;
    font-style: normal;
    font-size: 16px;
  }
  .gp-entry-meta .gp-post-meta-row-1,
  .gp-homepage #gp-content .gp-vc-element-3,
  .gp-homepage #gp-content .gp-vc-element-4,
  .gp-homepage #gp-content .gp-vc-element-5,
  .gp-homepage #gp-content .gp-vc-element-6,
  #comments .commentlist li .comment_container,
  .gp-loop-divider:before,
  .gp-recent-comments ul li,
  .gp-search {
    border-top: 1px solid #e0e0e0;
    border-bottom: 1px solid #e0e0e0;
  }
  .gp-entry-video-wrapper .gp-entry-meta .gp-post-meta-row-1,
  .gp-footer-widget .gp-recent-comments ul li {
    border-top: 1px solid #50504b;
    border-bottom: 1px solid #50504b;
  }
  #gp-main-header {
    background-color: #222222;
  }
  .gp-desktop-scrolling #gp-main-header {
    background-color: #222222;
  }
  #gp-primary-main-nav .menu > li,
  #gp-primary-main-nav .menu > li > a {
    font-family: Roboto;
    text-transform: none;
    line-height: 16px;
    font-weight: 400;
    font-style: normal;
    color: #ababab;
    font-size: 16px;
  }
  #gp-primary-main-nav .menu > li:hover > a,
  #gp-primary-main-nav .menu > li > a {
    color: #fff;
  }
  #gp-primary-main-nav .menu > li:hover > a:hover,
  #gp-primary-main-nav .menu > li > a:hover {
    color: #fff;
  }
  #gp-primary-main-nav .menu > li > a:hover,
  #gp-primary-main-nav .menu > li:hover > a {
    border-top: 3px solid #fff;
  }
  #gp-secondary-main-nav .menu > li,
  #gp-secondary-main-nav .menu > li > a {
    font-family: Roboto;
    text-transform: none;
    line-height: 14px;
    font-weight: 400;
    font-style: normal;
    color: #fff;
    font-size: 14px;
  }
  #gp-secondary-main-nav .menu > li:hover > a,
  #gp-secondary-main-nav .menu > li > a {
    color: #fff;
  }
  #gp-secondary-main-nav .menu > li:hover > a:hover,
  #gp-secondary-main-nav .menu > li > a:hover {
    color: #fff;
  }
  #gp-secondary-main-nav .menu > li > a:hover,
  #gp-secondary-main-nav .menu > li:hover > a {
    border-top: 3px solid #fff;
  }
  #gp-search-button,
  #gp-cart-button {
    color: #fff;
  }
  #gp-search-button:hover,
  #gp-cart-button:hover {
    color: #fff;
  }
  .gp-nav .sub-menu,
  .gp-nav .menu li .gp-menu-tabs li:hover,
  .gp-nav .menu li .gp-menu-tabs li.gp-selected,
  #gp-search-box {
    background-color: #fff;
  }
  .gp-nav .menu > .gp-standard-menu > .sub-menu > li a:hover,
  .gp-nav .menu > .gp-standard-menu > .sub-menu > li:hover > a {
    background-color: #353535;
  }
  .gp-nav .gp-standard-menu .sub-menu li,
  .gp-nav .gp-standard-menu .sub-menu li a,
  .gp-nav li.gp-megamenu .sub-menu li,
  .gp-nav .gp-megamenu .sub-menu li a {
    font-family: Roboto;
    font-weight: 400;
    font-style: normal;
    color: #000;
    font-size: 14px;
  }
  .gp-nav .menu > .gp-standard-menu > .sub-menu > li a {
    color: #000;
  }
  .gp-nav .menu > .gp-standard-menu > .sub-menu > li a:hover {
    color: #fff;
  }
  .gp-nav .sub-menu li,
  #gp-dropdowncart .total,
  #gp-dropdowncart .buttons {
    border-top: 1px solid #e0e0e0;
  }
  .gp-nav .gp-megamenu > .sub-menu > li > a,
  .gp-nav .gp-megamenu > .sub-menu > li > span {
    color: #000000;
  }
  .gp-nav li.gp-megamenu a {
    color: #000;
  }
  .gp-nav li.gp-megamenu a:hover {
    color: #e93100;
  }
  .gp-primary-dropdown-icon {
    color: #fff;
  }
  .gp-primary-dropdown-icon:hover {
    color: #fff;
  }
  .gp-secondary-dropdown-icon {
    color: #000;
  }
  .gp-secondary-dropdown-icon:hover {
    color: #fff;
  }
  .gp-menu-tabs {
    background-color: #353535;
  }
  .gp-nav .menu li .gp-menu-tabs li {
    color: #ffffff;
  }
  .gp-nav .menu li .gp-menu-tabs li:hover,
  .gp-nav .menu li .gp-menu-tabs li.gp-selected {
    color: #e93100;
  }
  #gp-small-header #gp-top-nav {
    background-color: #26a9e0;
  }
  #gp-small-header .menu > li,
  #gp-small-header .menu > li > a {
    color: #ffffff;
  }
  #gp-small-header .menu > li:hover,
  #gp-small-header .menu > li > a:hover {
    color: #e0e0e0;
  }
  #gp-mobile-nav-button,
  #gp-profile-button,
  #gp-mobile-nav-close-button {
    color: #ffffff;
  }
  #gp-mobile-nav {
    background-color: #fff;
  }
  #gp-mobile-nav-close-button {
    background-color: #0579bd;
  }
  #gp-mobile-nav li {
    color: #000000;
  }
  #gp-mobile-nav .menu li span,
  #gp-mobile-nav .menu li a {
    color: #000;
  }
  #gp-mobile-nav .menu li span:hover,
  #gp-mobile-nav .menu li a:hover {
    color: #000;
  }
  #gp-mobile-nav li a:hover {
    background-color: #f1f1f1;
  }
  #gp-mobile-nav li {
    border-top: 1px solid #e0e0e0;
  }
  #gp-mobile-nav .gp-megamenu > .sub-menu > li > a {
    color: #000000;
  }
  .gp-large-page-header .gp-page-header,
  .gp-fullwidth-page-header .gp-page-header,
  #gp-full-page-bg {
    background-color: #353535;
    background-repeat: no-repeat;
    background-attachment: scroll;
    background-position: center center;
    background-size: cover;
  }
  .gp-page-header h1,
  .gp-page-header h2 {
    font-family: Roboto;
    line-height: 90px;
    font-weight: normal;
    font-style: normal;
    color: #fff;
    font-size: 80px;
  }
  .gp-page-header .gp-container {
    height: 250px;
  }
  .gp-entry-title,
  .woocommerce .page-title,
  .woocommerce div.product .entry-title.product_title {
    font-family: Roboto;
    line-height: 46px;
    font-weight: 300;
    font-style: normal;
    color: #000;
    font-size: 40px;
  }
  .gp-subtitle {
    font-family: Roboto;
    line-height: 32px;
    font-weight: 300;
    font-style: normal;
    color: #0579bd;
    font-size: 20px;
  }
  #gp-post-links a,
  .gp-pagination-arrows a.prev,
  .gp-pagination-arrows a.next,
  .gp-carousel-wrapper .flex-direction-nav a {
    color: #aaa;
  }
  #gp-post-links a:hover,
  .gp-pagination-arrows a.prev:hover,
  .gp-pagination-arrows a.next:hover,
  .gp-carousel-wrapper .flex-direction-nav a:hover {
    color: #333;
  }
  .gp-entry-meta,
  .gp-meta-comments a {
    color: #aaaaaa;
  }
  .gp-entry-cats,
  .gp-entry-cats a,
  .gp-entry-cats a:hover {
    color: #ffffff;
  }
  .gp-entry-cats {
    background-color: #92d050;
  }
  .gp-entry-tags a,
  .gp-entry-tags a:hover {
    color: #ffffff;
  }
  .gp-entry-tags a {
    background-color: #353535;
  }
  .gp-author-info,
  #gp-post-navigation #gp-share-icons {
    background-color: #353535;
  }
  .gp-author-info,
  .gp-author-info a,
  #gp-post-navigation #gp-share-icons h3 {
    line-height: 24px;
    color: #fff;
    font-size: 14px;
  }
  .gp-author-info a {
    color: #b1b1b1;
  }
  .gp-author-info a:hover {
    color: #fff;
  }
  .gp-entry-video-wrapper {
    background-color: #353535;
  }
  .gp-entry-video-wrapper .gp-entry-title {
    color: #ffffff;
  }
  .gp-entry-video-wrapper .gp-video-description {
    color: #777777;
  }
  blockquote {
    background-color: #0579bd;
  }
  blockquote,
  blockquote a,
  blockquote a:hover {
    font-family: 'Roboto Slab';
    line-height: 38px;
    font-weight: 400;
    font-style: normal;
    color: #fff;
    font-size: 24px;
  }
  .gp-loop-title {
    line-height: 22px;
    font-weight: 400;
    font-size: 19px;
  }
  .gp-blog-large .gp-loop-title {
    line-height: 46px;
    font-weight: 200;
    font-size: 40px;
  }
  .gp-loop-title a,
  .bboss_search_item .entry-title a {
    color: #000;
  }
  .gp-loop-title a:hover,
  .bboss_search_item .entry-title a:hover {
    color: #0579bd;
  }
  .gp-loop-text,
  .gp-login-wrapper p {
    color: #545454;
  }
  .gp-loop-meta,
  .gp-loop-meta a,
  #gp-breadcrumbs,
  #gp-breadcrumbs a,
  .woocommerce .woocommerce-breadcrumb a,
  .woocommerce .woocommerce-breadcrumb,
  .comment-text time,
  div.bbp-breadcrumb,
  div.bbp-breadcrumb a,
  .gp-statistics-wrapper .gp-stat-title,
  .widget_display_replies ul li div,
  .widget_display_topics ul li div {
    color: #545454;
  }
  .gp-loop-cats,
  .gp-loop-cats a,
  .gp-loop-cats a:hover {
    color: #545454;
  }
  .gp-loop-tags,
  .gp-loop-tags a,
  .gp-loop-tags a:hover {
    color: #0579bd;
  }
  .gp-blog-masonry section,
  section.sticky {
    background-color: #f8f8f8;
  }
  ul.page-numbers .page-numbers {
    background-color: #538122;
  }
  ul.page-numbers .page-numbers:hover,
  ul.page-numbers .page-numbers.current,
  ul.page-numbers > span.page-numbers {
    background-color: #353535;
  }
  ul.page-numbers .page-numbers {
    color: #ffffff;
  }
  .widgettitle,
  .widget-title,
  .wp-block-search__label {
    font-family: Roboto;
    line-height: 18px;
    font-weight: 500;
    font-style: normal;
    color: #000;
    font-size: 14px;
  }
  .widgettitle a,
  .widget-title a,
  .wp-block-search__label {
    color: #0579bd;
  }
  .widgettitle a:hover,
  .widget-title a:hover,
  .wp-block-search__label:hover {
    color: #000;
  }
  .gp-sidebar .widgettitle,
  .widgettitle.gp-standard-title,
  .gp-sidebar .widget-title,
  .gp-sidebar .wp-block-search__label {
    border-bottom: 3px solid #538122;
  }
  .widget,
  .gp-vc-element,
  .widgettitle.gp-fancy-title .gp-widget-title,
  .widgettitle.gp-fancy-title .gp-element-icon,
  .widget .woocommerce {
    background-color: #ffffff;
  }
  .widgettitle.gp-fancy-title .gp-triangle {
    border-left-color: #ffffff;
  }
  input,
  textarea,
  .gp-search-bar,
  .wp-block-search__input,
  .gp-theme #buddypress .dir-search input[type='search'],
  .gp-theme #buddypress .dir-search input[type='text'],
  .gp-theme #buddypress .groups-members-search input[type='search'],
  .gp-theme #buddypress .standard-form input[type='color'],
  .gp-theme #buddypress .standard-form input[type='date'],
  .gp-theme #buddypress .standard-form input[type='datetime-local'],
  .gp-theme #buddypress .standard-form input[type='datetime'],
  .gp-theme #buddypress .standard-form input[type='email'],
  .gp-theme #buddypress .standard-form input[type='month'],
  .gp-theme #buddypress .standard-form input[type='number'],
  .gp-theme #buddypress .standard-form input[type='password'],
  .gp-theme #buddypress .standard-form input[type='range'],
  .gp-theme #buddypress .standard-form input[type='search'],
  .gp-theme #buddypress .standard-form input[type='tel'],
  .gp-theme #buddypress .standard-form input[type='text'],
  .gp-theme #buddypress .standard-form input[type='time'],
  .gp-theme #buddypress .standard-form input[type='url'],
  .gp-theme #buddypress .standard-form input[type='week'],
  .gp-theme #buddypress .standard-form textarea,
  .gp-theme #buddypress div.activity-comments form .ac-textarea,
  .gp-theme #buddypress form#whats-new-form textarea {
    background-color: #fafafa;
  }
  input,
  textarea,
  .gp-search-bar,
  .wp-block-search__input,
  .gp-login-wrapper .gp-login-icon,
  .gp-login-wrapper .gp-password-icon,
  .gp-login-wrapper .gp-email-icon,
  .gp-theme #buddypress .dir-search input[type='search'],
  .gp-theme #buddypress .dir-search input[type='text'],
  .gp-theme #buddypress .groups-members-search input[type='search'],
  .gp-theme #buddypress .standard-form input[type='color'],
  .gp-theme #buddypress .standard-form input[type='date'],
  .gp-theme #buddypress .standard-form input[type='datetime-local'],
  .gp-theme #buddypress .standard-form input[type='datetime'],
  .gp-theme #buddypress .standard-form input[type='email'],
  .gp-theme #buddypress .standard-form input[type='month'],
  .gp-theme #buddypress .standard-form input[type='number'],
  .gp-theme #buddypress .standard-form input[type='password'],
  .gp-theme #buddypress .standard-form input[type='range'],
  .gp-theme #buddypress .standard-form input[type='search'],
  .gp-theme #buddypress .standard-form input[type='tel'],
  .gp-theme #buddypress .standard-form input[type='text'],
  .gp-theme #buddypress .standard-form input[type='time'],
  .gp-theme #buddypress .standard-form input[type='url'],
  .gp-theme #buddypress .standard-form input[type='week'],
  .gp-theme #buddypress .standard-form textarea,
  .gp-theme #buddypress div.activity-comments form .ac-textarea,
  .bb-global-search-ac.ui-autocomplete {
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    border-left: 1px solid #ddd;
    border-right: 1px solid #ddd;
  }
  input,
  textarea,
  .gp-search-bar,
  .wp-block-search__input,
  .gp-theme #buddypress .dir-search input[type='search'],
  .gp-theme #buddypress .dir-search input[type='text'],
  .gp-theme #buddypress .groups-members-search input[type='search'],
  .gp-theme #buddypress .groups-members-search input[type='text'],
  .gp-theme #buddypress .standard-form input[type='color'],
  .gp-theme #buddypress .standard-form input[type='date'],
  .gp-theme #buddypress .standard-form input[type='datetime-local'],
  .gp-theme #buddypress .standard-form input[type='datetime'],
  .gp-theme #buddypress .standard-form input[type='email'],
  .gp-theme #buddypress .standard-form input[type='month'],
  .gp-theme #buddypress .standard-form input[type='number'],
  .gp-theme #buddypress .standard-form input[type='password'],
  .gp-theme #buddypress .standard-form input[type='range'],
  .gp-theme #buddypress .standard-form input[type='search'],
  .gp-theme #buddypress .standard-form input[type='tel'],
  .gp-theme #buddypress .standard-form input[type='text'],
  .gp-theme #buddypress .standard-form input[type='time'],
  .gp-theme #buddypress .standard-form input[type='url'],
  .gp-theme #buddypress .standard-form input[type='week'],
  .gp-theme #buddypress .standard-form textarea,
  .gp-theme #buddypress div.activity-comments form .ac-textarea,
  .gp-theme #buddypress form#whats-new-form textarea {
    color: #000000;
  }
  select,
  .gp-theme #buddypress .standard-form select,
  .gp-theme #buddypress form#whats-new-form #whats-new-options select,
  #buddypress .standard-form select:focus {
    background-color: #353535;
  }
  select,
  .gp-theme #buddypress .standard-form select,
  .gp-theme #buddypress form#whats-new-form #whats-new-options select {
    color: #ffffff;
  }
  input[type='button'],
  input[type='submit'],
  input[type='reset'],
  button,
  .button,
  .wp-block-search__button,
  .gp-theme #buddypress .comment-reply-link,
  .gp-notification-counter,
  #gp-cart-counter,
  .gp-theme #buddypress a.button,
  .gp-theme #buddypress button,
  .gp-theme #buddypress div.generic-button a,
  .gp-theme #buddypress input[type='button'],
  .gp-theme #buddypress input[type='reset'],
  .gp-theme #buddypress input[type='submit'],
  .gp-theme #buddypress ul.button-nav li a,
  a.bp-title-button,
  .gp-theme #buddypress .activity-list #reply-title small a span,
  .gp-theme #buddypress .activity-list a.bp-primary-action span,
  .tribe-events-calendar thead th,
  #tribe-events .tribe-events-button,
  #tribe-events .tribe-events-button:hover,
  #tribe_events_filters_wrapper input[type='submit'],
  .tribe-events-button,
  .tribe-events-button.tribe-active:hover,
  .tribe-events-button.tribe-inactive,
  .tribe-events-button:hover,
  .tribe-events-calendar td.tribe-events-present div[id*='tribe-events-daynum-'],
  .tribe-events-calendar td.tribe-events-present div[id*='tribe-events-daynum-'] > a,
  #tribe-bar-form .tribe-bar-submit input[type='submit'],
  .woocommerce #respond input#submit.alt,
  .woocommerce a.button.alt,
  .woocommerce button.button.alt,
  .woocommerce input.button.alt,
  #gp-dropdowncart .woocommerce a.button {
    background-color: #0579bd;
  }
  input[type='button']:hover,
  input[type='submit']:hover,
  input[type='reset']:hover,
  button:hover,
  .button:hover,
  .wp-block-search__button:hover,
  .gp-theme #buddypress .comment-reply-link:hover,
  .gp-theme #buddypress a.button:hover,
  .gp-theme #buddypress button:hover,
  .gp-theme #buddypress div.generic-button a:hover,
  .gp-theme #buddypress input[type='button']:hover,
  .gp-theme #buddypress input[type='reset']:hover,
  .gp-theme #buddypress input[type='submit']:hover,
  .gp-theme #buddypress ul.button-nav li a:hover,
  a.bp-title-button:hover,
  .gp-theme #buddypress .activity-list #reply-title small a:hover span,
  .gp-theme #buddypress .activity-list a.bp-primary-action:hover span,
  .woocommerce #respond input#submit.alt:hover,
  .woocommerce a.button.alt:hover,
  .woocommerce button.button.alt:hover,
  .woocommerce input.button.alt:hover,
  #gp-dropdowncart .woocommerce a.button:hover {
    background-color: #353535;
  }
  input[type='button'],
  input[type='submit'],
  input[type='reset'],
  button,
  .button,
  .wp-block-search__button,
  a.gp-notification-counter,
  a.gp-notification-counter:hover,
  #gp-cart-counter:hover,
  .gp-theme #buddypress .comment-reply-link,
  .gp-theme #buddypress a.button,
  .gp-theme #buddypress button,
  .gp-theme #buddypress div.generic-button a,
  .gp-theme #buddypress input[type='button'],
  .gp-theme #buddypress input[type='reset'],
  .gp-theme #buddypress input[type='submit'],
  .gp-theme #buddypress ul.button-nav li a,
  a.bp-title-button,
  .gp-theme #buddypress .activity-list #reply-title small a span,
  .gp-theme #buddypress .activity-list a.bp-primary-action span,
  #gp-dropdowncart .woocommerce a.button {
    color: #ffffff;
  }
  input[type='button']:hover,
  input[type='submit']:hover,
  input[type='reset']:hover,
  button,
  .button:hover,
  .wp-block-search__button:hover,
  .gp-theme #buddypress .comment-reply-link:hover,
  .gp-theme #buddypress a.button:hover,
  .gp-theme #buddypress button:hover,
  .gp-theme #buddypress div.generic-button a:hover,
  .gp-theme #buddypress input[type='button']:hover,
  .gp-theme #buddypress input[type='reset']:hover,
  .gp-theme #buddypress input[type='submit']:hover,
  .gp-theme #buddypress ul.button-nav li a:hover,
  a.bp-title-button:hover,
  .gp-theme #buddypress .activity-list #reply-title small a span,
  .gp-theme #buddypress .activity-list a.bp-primary-action span,
  #gp-dropdowncart .woocommerce a.button:hover {
    color: #ffffff;
  }
  #gp-footer {
    background-color: #353535;
  }
  .gp-footer-widget .widgettitle,
  .gp-footer-widget .widget-title,
  .gp-footer-widget .wp-block-search__label {
    font-family: Roboto;
    line-height: 20px;
    font-weight: 300;
    font-style: normal;
    color: #fff;
    font-size: 16px;
  }
  .gp-footer-widget {
    font-family: Roboto;
    line-height: 20px;
    font-weight: 300;
    font-style: normal;
    color: #ffffff;
    font-size: 14px;
  }
  .gp-footer-widget a {
    color: #f9bd16;
  }
  .gp-footer-widget a:hover {
    color: #b1b1b1;
  }
  #gp-copyright {
    background-color: #353535;
  }
  #gp-copyright {
    border-top: 1px solid #444;
  }
  #gp-copyright {
    color: #777777;
  }
  #gp-copyright a {
    color: #999;
  }
  #gp-copyright a:hover {
    color: #e0e0e0;
  }
  #gp-to-top {
    background-color: #0579bd;
  }
  #gp-to-top {
    color: #ffffff;
  }
</style>
  <link rel="icon" href="enviroDIY_Favicon.png" type="image/png" />
  <link rel="prev" href="_test_commands_8ino-example.html" />
  <link rel="next" href="_test_warm_up_8ino-example.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#cb4b16" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
</head>

<body
    class="theme-socialize page-template-socialize-child gp-theme gp-responsive gp-wide-layout gp-retina gp-normal-scrolling gp-no-back-to-top gp-relative-header gp-header-standard gp-cart-disabled gp-search-all gp-profile-disabled gp-small-header-all gp-standard-page-header gp-no-sidebar"
>
	<div id="gp-site-wrapper">

  <nav id="gp-mobile-nav">
    <div id="gp-mobile-nav-close-button"></div>
    <ul class="menu">
      <li
        class="gp-standard-menu gp-columns-1 gp-show-all main-menu-item menu-item-even menu-item-depth-0 menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"
      >
<a href="class_s_d_i12.html" class="menu-link main-menu-link">SDI12</a>        <ul class="sub-menu menu-odd menu-depth-1">
          <li
            class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
          >
<a href="class_s_d_i12.html#constructor-destructor-begins-and-setters">Constructor, Destructor, Begins, and Setters</a>          </li>
          <li
            class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
          >
<a href="class_s_d_i12.html#waking-up-and-talking-to-sensors">Waking Up and Talking To Sensors</a>          </li>
          <li
            class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
          >
<a href="class_s_d_i12.html#reading-from-the-sdi-12-buffer">Reading from the SDI-12 Buffer</a>          </li>
          <li
            class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
          >
<a href="class_s_d_i12.html#data-line-states">Data Line States</a>          </li>
          <li
            class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
          >
<a href="class_s_d_i12.html#using-more-than-one-sdi-12-object">Using more than one SDI-12 Object</a>          </li>
          <li
            class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
          >
<a href="class_s_d_i12.html#interrupt-service-routine">Interrupt Service Routine</a>          </li>
        </ul>
      </li>
      <li
        class="gp-standard-menu gp-columns-1 gp-show-all main-menu-item menu-item-even menu-item-depth-0 menu-item menu-item-type-post_type menu-item-object-page"
      >
<a href="examples_page.html" class="menu-link main-menu-link">Examples using the SDI-12 Library</a>      </li>
      <li
        class="gp-standard-menu gp-columns-1 gp-show-all main-menu-item menu-item-even menu-item-depth-0 menu-item menu-item-type-post_type menu-item-object-page"
      >
<a href="annotated.html" class="menu-link main-menu-link">Classes</a>      </li>
      <li
        class="gp-standard-menu gp-columns-1 gp-show-all main-menu-item menu-item-even menu-item-depth-0 menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"
      >
<a href="pages.html" class="menu-link main-menu-link">Notes</a>        <ul class="sub-menu menu-odd menu-depth-1">
          <li
            class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
          >
<a class="menu-link sub-menu-link" href="specifications.html">Notes on SDI-12, Specification v1.4</a>          </li>
          <li
            class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
          >
<a class="menu-link sub-menu-link" href="interrupts_page.html">Overview of Interrupts</a>          </li>
          <li
            class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
          >
<a class="menu-link sub-menu-link" href="rx_page.html">Creating a Character - Stepping through the Rx ISR</a>          </li>
        </ul>
      </li>
    </ul>
  </nav> <!-- gp-mobile-nav -->
  <div id="gp-mobile-nav-bg"></div>

  <div id="gp-page-wrapper">

    <header id="gp-main-header">
      <div class="gp-container">
        <div id="gp-logo">
          <a href="index.html" title="SDI-12 for Arduino 2.2.0">
            <img
              src="gp-desktop-logo.png"
              alt="SDI-12 for Arduino 2.2.0"
              width="200"
              height="42"
              class="gp-desktop-logo"
            />
            <img
              src="gp-scrolling-logo.png"
              alt="SDI-12 for Arduino 2.2.0"
              width="264"
              height="55"
              class="gp-scrolling-logo"
            />
            <img
              src="gp-mobile-logo.png"
              alt="SDI-12 for Arduino 2.2.0"
              width="132"
              height="28"
              class="gp-mobile-logo"
            />
          </a>
        </div> <!-- gp-logo -->

        <a id="gp-mobile-nav-button"></a>

        <nav id="gp-main-nav" class="gp-nav">
          <nav id="gp-primary-main-nav">
            <ul id="menu-main-menu-1" class="menu">
              <li
                class="gp-standard-menu gp-columns-1 gp-show-all main-menu-item menu-item-even menu-item-depth-0 menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"
              >
<a href="class_s_d_i12.html" class="menu-link main-menu-link" >SDI12</a>                <ul class="sub-menu menu-odd menu-depth-1">
                  <li
                    class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
                  >
<a href="class_s_d_i12.html#constructor-destructor-begins-and-setters">Constructor, Destructor, Begins, and Setters</a>                  </li>
                  <li
                    class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
                  >
<a href="class_s_d_i12.html#waking-up-and-talking-to-sensors">Waking Up and Talking To Sensors</a>                  </li>
                  <li
                    class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
                  >
<a href="class_s_d_i12.html#reading-from-the-sdi-12-buffer">Reading from the SDI-12 Buffer</a>                  </li>
                  <li
                    class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
                  >
<a href="class_s_d_i12.html#data-line-states">Data Line States</a>                  </li>
                  <li
                    class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
                  >
<a href="class_s_d_i12.html#using-more-than-one-sdi-12-object">Using more than one SDI-12 Object</a>                  </li>
                  <li
                    class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
                  >
<a href="class_s_d_i12.html#interrupt-service-routine">Interrupt Service Routine</a>                  </li>
                </ul>
              </li>
              <li
                class="gp-standard-menu gp-columns-1 gp-show-all main-menu-item menu-item-even menu-item-depth-0 menu-item menu-item-type-post_type menu-item-object-page"
              >
<a href="examples_page.html"class="menu-link main-menu-link">Examples using the SDI-12 Library</a>              </li>
              <li
                class="gp-standard-menu gp-columns-1 gp-show-all main-menu-item menu-item-even menu-item-depth-0 menu-item menu-item-type-post_type menu-item-object-page"
              >
<a href="annotated.html"class="menu-link main-menu-link">Classes</a>              </li>
              <li
                class="gp-standard-menu gp-columns-1 gp-show-all main-menu-item menu-item-even menu-item-depth-0 menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"
              >
<a href="pages.html" class="menu-link main-menu-link" >Notes</a>                <ul class="sub-menu menu-odd menu-depth-1">
                  <li
                    class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
                  >
<a class="menu-link sub-menu-link" href="specifications.html">Notes on SDI-12, Specification v1.4</a>                  </li>
                  <li
                    class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
                  >
<a class="menu-link sub-menu-link" href="interrupts_page.html">Overview of Interrupts</a>                  </li>
                  <li
                    class="gp-standard-menu gp-menu-link gp-show-all sub-menu-item menu-item-odd menu-item-depth-1 menu-item menu-item-type-post_type menu-item-object-page"
                  >
<a class="menu-link sub-menu-link" href="rx_page.html">Creating a Character - Stepping through the Rx ISR</a>                  </li>
                </ul>
              </li>
            </ul>
          </nav> <!-- gp-primary-main-nav -->

          <div id="gp-search">
            <div id="m-search-button" class="m-show-m" onclick="return showSearch()">
            </div> <!-- gp-search-box -->
          </div> <!-- gp-search -->

          <nav id="gp-secondary-main-nav"></nav>
        </nav> <!-- gp-main-nav -->
      </div> <!-- gp-container -->
    </header> <!-- gp-main-header -->

    <header id="gp-small-header">
      <div class="gp-container">
        <div class="gp-left-triangle"></div>
        <div class="gp-right-triangle"></div>

        <nav id="gp-top-nav" class="gp-nav">
          <div id="gp-left-top-nav">
            <p style="color:#fff">An Arduino library for SDI-12 communication without requiring any additional hardware.</p>
          </div>

          <div id="gp-right-top-nav">
            <ul id="menu-icon-links" class="menu">
              <li
                class="gp-standard-menu gp-columns-1 gp-show-all main-menu-item menu-item-even menu-item-depth-0 fa fa-github menu-item menu-item-type-custom menu-item-object-custom"
              >
                <a
                  title="See it on GitHub"
                  href="https://github.com/EnviroDIY/Arduino-SDI-12"
                  class="menu-link main-menu-link"
                  >See the source code on GitHub</a
                >
              </li>
            </ul>
          </div>

        </nav>
      </div>
    </header> <!-- gp-small-header -->

    <div id="gp-fixed-header-padding"></div>

    <div class="m-doc-search" id="search">
      <a href="#!" onclick="return hideSearch()"></a>
      <div id="gp-header-area">
        <div class="gp-container">
          <div style="background-color:#fff;padding:20px;">
            <div class="m-doc-search-header m-text m-small">
              <div><span class="m-label m-info">Tab</span> / <span class="m-label m-info">T</span> to search, <span class="m-label m-info">Esc</span> to close</div>
              <div id="search-symbolcount">&hellip;</div>
            </div>
            <div class="m-doc-search-content">
              <form>
                <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
              </form>
              <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
              <div id="search-help" class="m-text m-dim m-text-center">
                <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
              </div>
              <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
              <ul id="search-results"></ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="search-v2.js"></script>
    <script src="searchdata-v2.js" async="async"></script>

    <div class="gp-clear"></div>

    <div id="gp-content-wrapper" class="gp-container">
      <div id="gp-inner-container">
        <div id="gp-left-column">
          <div id="gp-content">

            <main>
              <article>
                <div class="breadcrumbs" typeof="BreadcrumbList" vocab="http://schema.org/">
          <span class="m-breadcrumb">
            <a href="index.html">
              SDI-12 for Arduino
            </a>  &gt; <wbr/>
          </span>
                    <span class="m-breadcrumb">
          <a href="examples_page.html">
            Examples using the SDI-12 Library
          </a> &gt; <wbr/>
          </span>
          <span class="m-breadcrumb">
            TestSensorTiming.ino
          </span>
                </div>
                <header class="gp-entry-header">
                  <h1 class="gp-entry-title" itemprop="headline">
          TestSensorTiming.ino <span class="m-thin">example</span>


                </h1>
                </header>
        <aside class="m-note m-default"><h4>Copyright</h4><p>Stroud Water Research Center</p></aside><aside class="m-note m-default"><h4>License</h4><p>This example is published under the BSD-3 license.</p></aside><aside class="m-note m-default"><h4>Author</h4><p>Sara Damiano <a href="mailto:sdamiano@stroudcenter.org">sdamiano@stroudcenter.org</a></p></aside><aside class="m-note m-default"><h4>Date</h4><p>March 2024</p></aside><div class="m-code-arduino"><div class="highlight"><div class="line"><a id="l-1" name="l-1"></a><span class="linenos">  1</span><span class="cm">/**</span>
</div><div class="line"><a id="l-2" name="l-2"></a><span class="linenos">  2</span><span class="cm"> * @example{lineno} TestSensorTiming.ino</span>
</div><div class="line"><a id="l-3" name="l-3"></a><span class="linenos">  3</span><span class="cm"> * @copyright Stroud Water Research Center</span>
</div><div class="line"><a id="l-4" name="l-4"></a><span class="linenos">  4</span><span class="cm"> * @license This example is published under the BSD-3 license.</span>
</div><div class="line"><a id="l-5" name="l-5"></a><span class="linenos">  5</span><span class="cm"> * @author Sara Damiano &lt;sdamiano@stroudcenter.org&gt;</span>
</div><div class="line"><a id="l-6" name="l-6"></a><span class="linenos">  6</span><span class="cm"> * @date March 2024</span>
</div><div class="line"><a id="l-7" name="l-7"></a><span class="linenos">  7</span><span class="cm"> */</span>
</div><div class="line"><a id="l-8" name="l-8"></a><span class="linenos">  8</span>
</div><div class="line"><a id="l-9" name="l-9"></a><span class="linenos">  9</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SDI12.h&gt;</span>
</div><div class="line"><a id="l-10" name="l-10"></a><span class="linenos"> 10</span>
</div><div class="line"><a id="l-11" name="l-11"></a><span class="linenos"> 11</span><span class="cp">#ifndef SDI12_DATA_PIN</span>
</div><div class="line"><a id="l-12" name="l-12"></a><span class="linenos"> 12</span><span class="cp">#define SDI12_DATA_PIN 7</span>
</div><div class="line"><a id="l-13" name="l-13"></a><span class="linenos"> 13</span><span class="cp">#endif</span>
</div><div class="line"><a id="l-14" name="l-14"></a><span class="linenos"> 14</span><span class="cp">#ifndef SDI12_POWER_PIN</span>
</div><div class="line"><a id="l-15" name="l-15"></a><span class="linenos"> 15</span><span class="cp">#define SDI12_POWER_PIN 22</span>
</div><div class="line"><a id="l-16" name="l-16"></a><span class="linenos"> 16</span><span class="cp">#endif</span>
</div><div class="line"><a id="l-17" name="l-17"></a><span class="linenos"> 17</span>
</div><div class="line"><a id="l-18" name="l-18"></a><span class="linenos"> 18</span><span class="cm">/* connection information */</span>
</div><div class="line"><a id="l-19" name="l-19"></a><span class="linenos"> 19</span><span class="kr">uint32_t</span><span class="w"> </span><span class="n">serialBaud</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">115200</span><span class="p">;</span><span class="w">         </span><span class="cm">/*!&lt; The baud rate for the output serial port */</span>
</div><div class="line"><a id="l-20" name="l-20"></a><span class="linenos"> 20</span><span class="kr">int8_t</span><span class="w">   </span><span class="n">dataPin</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">SDI12_DATA_PIN</span><span class="p">;</span><span class="w"> </span><span class="cm">/*!&lt; The pin of the SDI-12 data bus */</span>
</div><div class="line"><a id="l-21" name="l-21"></a><span class="linenos"> 21</span><span class="kr">int8_t</span><span class="w">   </span><span class="n">powerPin</span><span class="w"> </span><span class="o">=</span>
</div><div class="line"><a id="l-22" name="l-22"></a><span class="linenos"> 22</span><span class="w">  </span><span class="n">SDI12_POWER_PIN</span><span class="p">;</span><span class="w">          </span><span class="cm">/*!&lt; The sensor power pin (or -1 if not switching power) */</span>
</div><div class="line"><a id="l-23" name="l-23"></a><span class="linenos"> 23</span><span class="kr">uint32_t</span><span class="w"> </span><span class="n">wake_delay</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="cm">/*!&lt; Extra time needed for the sensor to wake (0-100ms) */</span>
</div><div class="line"><a id="l-24" name="l-24"></a><span class="linenos"> 24</span><span class="kr">char</span><span class="w">     </span><span class="n">sensorAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span><span class="w"> </span><span class="cm">/*!&lt; The address of the SDI-12 sensor */</span>
</div><div class="line"><a id="l-25" name="l-25"></a><span class="linenos"> 25</span>
</div><div class="line"><a id="l-26" name="l-26"></a><span class="linenos"> 26</span><span class="cm">/** Define the SDI-12 bus */</span>
</div><div class="line"><a id="l-27" name="l-27"></a><span class="linenos"> 27</span><span class="n">SDI12</span><span class="w"> </span><span class="nf">mySDI12</span><span class="p">(</span><span class="n">dataPin</span><span class="p">);</span>
</div><div class="line"><a id="l-28" name="l-28"></a><span class="linenos"> 28</span>
</div><div class="line"><a id="l-29" name="l-29"></a><span class="linenos"> 29</span><span class="cm">/** Define some testing specs */</span>
</div><div class="line"><a id="l-30" name="l-30"></a><span class="linenos"> 30</span>
</div><div class="line"><a id="l-31" name="l-31"></a><span class="linenos"> 31</span><span class="cm">/** Error codes, if returned */</span>
</div><div class="line"><a id="l-32" name="l-32"></a><span class="linenos"> 32</span><span class="kr">int8_t</span><span class="w"> </span><span class="n">error_result_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
</div><div class="line"><a id="l-33" name="l-33"></a><span class="linenos"> 33</span><span class="kr">float</span><span class="w">  </span><span class="n">no_error_value</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-34" name="l-34"></a><span class="linenos"> 34</span>
</div><div class="line"><a id="l-35" name="l-35"></a><span class="linenos"> 35</span><span class="cm">/** Testing turning off power */</span>
</div><div class="line"><a id="l-36" name="l-36"></a><span class="linenos"> 36</span><span class="kr">bool</span><span class="w">    </span><span class="n">testPowerOff</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-37" name="l-37"></a><span class="linenos"> 37</span><span class="kr">int32_t</span><span class="w"> </span><span class="n">min_power_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100L</span><span class="p">;</span><span class="w">       </span><span class="cm">/*!&lt; The min time to test wake after power on. */</span>
</div><div class="line"><a id="l-38" name="l-38"></a><span class="linenos"> 38</span><span class="kr">int32_t</span><span class="w"> </span><span class="n">max_power_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">180000L</span><span class="p">;</span><span class="w">    </span><span class="cm">/*!&lt; The max time to test wake after power on. */</span>
</div><div class="line"><a id="l-39" name="l-39"></a><span class="linenos"> 39</span><span class="kr">int32_t</span><span class="w"> </span><span class="n">increment_power_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100L</span><span class="p">;</span><span class="w"> </span><span class="cm">/*!&lt; The time to lengthen waits between reps. */</span>
</div><div class="line"><a id="l-40" name="l-40"></a><span class="linenos"> 40</span><span class="kr">int32_t</span><span class="w"> </span><span class="n">power_off_time</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mf">60000L</span><span class="p">;</span><span class="w"> </span><span class="cm">/*!&lt; The time to power off between tests. */</span>
</div><div class="line"><a id="l-41" name="l-41"></a><span class="linenos"> 41</span><span class="cm">/** NOTE: set the power off time to be something similar to what you will be using the</span>
</div><div class="line"><a id="l-42" name="l-42"></a><span class="linenos"> 42</span><span class="cm"> * the real world! Some sensors take longer to warm up if they&#39;ve been off for a while.</span>
</div><div class="line"><a id="l-43" name="l-43"></a><span class="linenos"> 43</span><span class="cm"> */</span>
</div><div class="line"><a id="l-44" name="l-44"></a><span class="linenos"> 44</span>
</div><div class="line"><a id="l-45" name="l-45"></a><span class="linenos"> 45</span><span class="cm">/** Testing the length of the break */</span>
</div><div class="line"><a id="l-46" name="l-46"></a><span class="linenos"> 46</span><span class="kr">bool</span><span class="w">    </span><span class="n">testBreak</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-47" name="l-47"></a><span class="linenos"> 47</span><span class="kr">int32_t</span><span class="w"> </span><span class="n">min_wake_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">   </span><span class="cm">/*!&lt; The min time to test wake after a line break. */</span>
</div><div class="line"><a id="l-48" name="l-48"></a><span class="linenos"> 48</span><span class="kr">int32_t</span><span class="w"> </span><span class="n">max_wake_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="cm">/*!&lt; The max time to test wake (should be &lt;=100). */</span>
</div><div class="line"><a id="l-49" name="l-49"></a><span class="linenos"> 49</span><span class="kr">int32_t</span><span class="w"> </span><span class="n">increment_wake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">   </span><span class="cm">/*!&lt; The time to lengthen waits between reps. */</span>
</div><div class="line"><a id="l-50" name="l-50"></a><span class="linenos"> 50</span>
</div><div class="line"><a id="l-51" name="l-51"></a><span class="linenos"> 51</span><span class="cm">/** set some initial values */</span>
</div><div class="line"><a id="l-52" name="l-52"></a><span class="linenos"> 52</span><span class="kr">int32_t</span><span class="w"> </span><span class="n">power_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min_power_delay</span><span class="p">;</span>
</div><div class="line"><a id="l-53" name="l-53"></a><span class="linenos"> 53</span><span class="kr">int32_t</span><span class="w"> </span><span class="n">wake_delay</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">min_wake_delay</span><span class="p">;</span>
</div><div class="line"><a id="l-54" name="l-54"></a><span class="linenos"> 54</span>
</div><div class="line"><a id="l-55" name="l-55"></a><span class="linenos"> 55</span><span class="kr">int32_t</span><span class="w">  </span><span class="n">total_meas_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-56" name="l-56"></a><span class="linenos"> 56</span><span class="kr">int32_t</span><span class="w">  </span><span class="n">total_meas_made</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-57" name="l-57"></a><span class="linenos"> 57</span><span class="kr">uint32_t</span><span class="w"> </span><span class="n">max_meas_time</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-58" name="l-58"></a><span class="linenos"> 58</span>
</div><div class="line"><a id="l-59" name="l-59"></a><span class="linenos"> 59</span><span class="kr">struct</span><span class="w"> </span><span class="nc">startMeasurementResult</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Structure declaration</span>
</div><div class="line"><a id="l-60" name="l-60"></a><span class="linenos"> 60</span><span class="w">  </span><span class="kr">String</span><span class="w">  </span><span class="n">returned_address</span><span class="p">;</span>
</div><div class="line"><a id="l-61" name="l-61"></a><span class="linenos"> 61</span><span class="w">  </span><span class="kr">uint8_t</span><span class="w"> </span><span class="n">meas_time_s</span><span class="p">;</span>
</div><div class="line"><a id="l-62" name="l-62"></a><span class="linenos"> 62</span><span class="w">  </span><span class="kr">int</span><span class="w">     </span><span class="n">numberResults</span><span class="p">;</span>
</div><div class="line"><a id="l-63" name="l-63"></a><span class="linenos"> 63</span><span class="p">};</span>
</div><div class="line"><a id="l-64" name="l-64"></a><span class="linenos"> 64</span>
</div><div class="line"><a id="l-65" name="l-65"></a><span class="linenos"> 65</span><span class="kr">struct</span><span class="w"> </span><span class="nc">getResultsResult</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Structure declaration</span>
</div><div class="line"><a id="l-66" name="l-66"></a><span class="linenos"> 66</span><span class="w">  </span><span class="kr">uint8_t</span><span class="w"> </span><span class="n">resultsReceived</span><span class="p">;</span>
</div><div class="line"><a id="l-67" name="l-67"></a><span class="linenos"> 67</span><span class="w">  </span><span class="kr">uint8_t</span><span class="w"> </span><span class="n">maxDataCommand</span><span class="p">;</span>
</div><div class="line"><a id="l-68" name="l-68"></a><span class="linenos"> 68</span><span class="w">  </span><span class="kr">bool</span><span class="w">    </span><span class="n">addressMatch</span><span class="p">;</span>
</div><div class="line"><a id="l-69" name="l-69"></a><span class="linenos"> 69</span><span class="w">  </span><span class="kr">bool</span><span class="w">    </span><span class="n">crcMatch</span><span class="p">;</span>
</div><div class="line"><a id="l-70" name="l-70"></a><span class="linenos"> 70</span><span class="w">  </span><span class="kr">bool</span><span class="w">    </span><span class="n">errorCode</span><span class="p">;</span>
</div><div class="line"><a id="l-71" name="l-71"></a><span class="linenos"> 71</span><span class="w">  </span><span class="kr">bool</span><span class="w">    </span><span class="n">success</span><span class="p">;</span>
</div><div class="line"><a id="l-72" name="l-72"></a><span class="linenos"> 72</span><span class="p">};</span>
</div><div class="line"><a id="l-73" name="l-73"></a><span class="linenos"> 73</span>
</div><div class="line"><a id="l-74" name="l-74"></a><span class="linenos"> 74</span><span class="n">getResultsResult</span><span class="w"> </span><span class="nf">getResults</span><span class="p">(</span><span class="kr">char</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="kr">int</span><span class="w"> </span><span class="n">resultsExpected</span><span class="p">,</span><span class="w"> </span><span class="kr">bool</span><span class="w"> </span><span class="n">verify_crc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">,</span>
</div><div class="line"><a id="l-75" name="l-75"></a><span class="linenos"> 75</span><span class="w">                            </span><span class="kr">bool</span><span class="w"> </span><span class="n">printCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-76" name="l-76"></a><span class="linenos"> 76</span><span class="w">  </span><span class="kr">uint8_t</span><span class="w"> </span><span class="n">resultsReceived</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-77" name="l-77"></a><span class="linenos"> 77</span><span class="w">  </span><span class="kr">uint8_t</span><span class="w"> </span><span class="n">cmd_number</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-78" name="l-78"></a><span class="linenos"> 78</span><span class="w">  </span><span class="c1">// The maximum number of characters that can be returned in the &lt;values&gt; part of the</span>
</div><div class="line"><a id="l-79" name="l-79"></a><span class="linenos"> 79</span><span class="w">  </span><span class="c1">// response to a D command is either 35 or 75. If the D command is issued to</span>
</div><div class="line"><a id="l-80" name="l-80"></a><span class="linenos"> 80</span><span class="w">  </span><span class="c1">// retrieve data in response to a concurrent measurement command, or in response to</span>
</div><div class="line"><a id="l-81" name="l-81"></a><span class="linenos"> 81</span><span class="w">  </span><span class="c1">// a high-volume ASCII measurement command, the maximum is 75. The maximum is also</span>
</div><div class="line"><a id="l-82" name="l-82"></a><span class="linenos"> 82</span><span class="w">  </span><span class="c1">// 75 in response to a continuous measurement command. Otherwise, the maximum is 35.</span>
</div><div class="line"><a id="l-83" name="l-83"></a><span class="linenos"> 83</span><span class="w">  </span><span class="kr">int</span><span class="w"> </span><span class="n">max_sdi_response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">76</span><span class="p">;</span>
</div><div class="line"><a id="l-84" name="l-84"></a><span class="linenos"> 84</span><span class="w">  </span><span class="c1">// max chars in a unsigned 64 bit number</span>
</div><div class="line"><a id="l-85" name="l-85"></a><span class="linenos"> 85</span><span class="w">  </span><span class="kr">int</span><span class="w"> </span><span class="n">max_sdi_digits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">21</span><span class="p">;</span>
</div><div class="line"><a id="l-86" name="l-86"></a><span class="linenos"> 86</span>
</div><div class="line"><a id="l-87" name="l-87"></a><span class="linenos"> 87</span><span class="w">  </span><span class="kr">String</span><span class="w"> </span><span class="n">compiled_response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
</div><div class="line"><a id="l-88" name="l-88"></a><span class="linenos"> 88</span>
</div><div class="line"><a id="l-89" name="l-89"></a><span class="linenos"> 89</span><span class="w">  </span><span class="kr">bool</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-90" name="l-90"></a><span class="linenos"> 90</span>
</div><div class="line"><a id="l-91" name="l-91"></a><span class="linenos"> 91</span><span class="w">  </span><span class="c1">// Create the return struct</span>
</div><div class="line"><a id="l-92" name="l-92"></a><span class="linenos"> 92</span><span class="w">  </span><span class="n">getResultsResult</span><span class="w"> </span><span class="n">return_result</span><span class="p">;</span>
</div><div class="line"><a id="l-93" name="l-93"></a><span class="linenos"> 93</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">resultsReceived</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-94" name="l-94"></a><span class="linenos"> 94</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">maxDataCommand</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-95" name="l-95"></a><span class="linenos"> 95</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">addressMatch</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-96" name="l-96"></a><span class="linenos"> 96</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">crcMatch</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-97" name="l-97"></a><span class="linenos"> 97</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">errorCode</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-98" name="l-98"></a><span class="linenos"> 98</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">success</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-99" name="l-99"></a><span class="linenos"> 99</span>
</div><div class="line"><a id="l-100" name="l-100"></a><span class="linenos">100</span><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">resultsReceived</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">resultsExpected</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cmd_number</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-101" name="l-101"></a><span class="linenos">101</span><span class="w">    </span><span class="kr">String</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
</div><div class="line"><a id="l-102" name="l-102"></a><span class="linenos">102</span><span class="w">    </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
</div><div class="line"><a id="l-103" name="l-103"></a><span class="linenos">103</span><span class="w">    </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">;</span>
</div><div class="line"><a id="l-104" name="l-104"></a><span class="linenos">104</span><span class="w">    </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">cmd_number</span><span class="p">;</span>
</div><div class="line"><a id="l-105" name="l-105"></a><span class="linenos">105</span><span class="w">    </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;!&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1">// SDI-12 command to get data [address][D][dataOption][!]</span>
</div><div class="line"><a id="l-106" name="l-106"></a><span class="linenos">106</span><span class="w">    </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">sendCommand</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">wake_delay</span><span class="p">);</span>
</div><div class="line"><a id="l-107" name="l-107"></a><span class="linenos">107</span>
</div><div class="line"><a id="l-108" name="l-108"></a><span class="linenos">108</span><span class="w">    </span><span class="c1">// uint32_t start = millis();</span>
</div><div class="line"><a id="l-109" name="l-109"></a><span class="linenos">109</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-110" name="l-110"></a><span class="linenos">110</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;&gt;&gt;&gt;&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-111" name="l-111"></a><span class="linenos">111</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>
</div><div class="line"><a id="l-112" name="l-112"></a><span class="linenos">112</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-113" name="l-113"></a><span class="linenos">113</span><span class="w">    </span><span class="kr">char</span><span class="w"> </span><span class="n">resp_buffer</span><span class="p">[</span><span class="n">max_sdi_response</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="sc">&#39;\0&#39;</span><span class="p">};</span>
</div><div class="line"><a id="l-114" name="l-114"></a><span class="linenos">114</span>
</div><div class="line"><a id="l-115" name="l-115"></a><span class="linenos">115</span><span class="w">    </span><span class="c1">// read bytes into the char array until we get to a new line (\r\n)</span>
</div><div class="line"><a id="l-116" name="l-116"></a><span class="linenos">116</span><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">bytes_read</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mySDI12</span><span class="p">.</span><span class="nf">readBytesUntil</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">resp_buffer</span><span class="p">,</span><span class="w"> </span><span class="n">max_sdi_response</span><span class="p">);</span>
</div><div class="line"><a id="l-117" name="l-117"></a><span class="linenos">117</span><span class="w">    </span><span class="c1">// Serial.print(bytes_read);</span>
</div><div class="line"><a id="l-118" name="l-118"></a><span class="linenos">118</span><span class="w">    </span><span class="c1">// Serial.println(&quot; characters&quot;);</span>
</div><div class="line"><a id="l-119" name="l-119"></a><span class="linenos">119</span>
</div><div class="line"><a id="l-120" name="l-120"></a><span class="linenos">120</span><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">data_bytes_read</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bytes_read</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// subtract one for the /r before the /n</span>
</div><div class="line"><a id="l-121" name="l-121"></a><span class="linenos">121</span><span class="w">    </span><span class="kr">String</span><span class="w"> </span><span class="n">sdiResponse</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="kr">String</span><span class="p">(</span><span class="n">resp_buffer</span><span class="p">);</span>
</div><div class="line"><a id="l-122" name="l-122"></a><span class="linenos">122</span><span class="w">    </span><span class="n">compiled_response</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">sdiResponse</span><span class="p">;</span>
</div><div class="line"><a id="l-123" name="l-123"></a><span class="linenos">123</span><span class="w">    </span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">trim</span><span class="p">();</span>
</div><div class="line"><a id="l-124" name="l-124"></a><span class="linenos">124</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-125" name="l-125"></a><span class="linenos">125</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;&lt;&lt;&lt;&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-126" name="l-126"></a><span class="linenos">126</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">);</span>
</div><div class="line"><a id="l-127" name="l-127"></a><span class="linenos">127</span><span class="w">      </span><span class="c1">// Serial.println(sdiResponse.length());</span>
</div><div class="line"><a id="l-128" name="l-128"></a><span class="linenos">128</span><span class="w">      </span><span class="c1">// Serial.print(&quot;&lt;&lt;&lt;&quot;);</span>
</div><div class="line"><a id="l-129" name="l-129"></a><span class="linenos">129</span><span class="w">      </span><span class="c1">// Serial.println(resp_buffer);</span>
</div><div class="line"><a id="l-130" name="l-130"></a><span class="linenos">130</span><span class="w">      </span><span class="c1">// Serial.println(strnlen(resp_buffer, max_sdi_response));</span>
</div><div class="line"><a id="l-131" name="l-131"></a><span class="linenos">131</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-132" name="l-132"></a><span class="linenos">132</span><span class="w">    </span><span class="c1">// read and clear anything else from the buffer</span>
</div><div class="line"><a id="l-133" name="l-133"></a><span class="linenos">133</span><span class="w">    </span><span class="kr">int</span><span class="w"> </span><span class="n">extra_chars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-134" name="l-134"></a><span class="linenos">134</span><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">mySDI12</span><span class="p">.</span><span class="nf">available</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-135" name="l-135"></a><span class="linenos">135</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">mySDI12</span><span class="p">.</span><span class="nf">read</span><span class="p">());</span>
</div><div class="line"><a id="l-136" name="l-136"></a><span class="linenos">136</span><span class="w">      </span><span class="n">extra_chars</span><span class="o">++</span><span class="p">;</span>
</div><div class="line"><a id="l-137" name="l-137"></a><span class="linenos">137</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-138" name="l-138"></a><span class="linenos">138</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">extra_chars</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-139" name="l-139"></a><span class="linenos">139</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">extra_chars</span><span class="p">);</span>
</div><div class="line"><a id="l-140" name="l-140"></a><span class="linenos">140</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot; additional characters received.&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-141" name="l-141"></a><span class="linenos">141</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-142" name="l-142"></a><span class="linenos">142</span><span class="w">    </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">clearBuffer</span><span class="p">();</span>
</div><div class="line"><a id="l-143" name="l-143"></a><span class="linenos">143</span>
</div><div class="line"><a id="l-144" name="l-144"></a><span class="linenos">144</span><span class="w">    </span><span class="c1">// check the address, break if it&#39;s incorrect</span>
</div><div class="line"><a id="l-145" name="l-145"></a><span class="linenos">145</span><span class="w">    </span><span class="kr">char</span><span class="w"> </span><span class="n">returned_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resp_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</div><div class="line"><a id="l-146" name="l-146"></a><span class="linenos">146</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">returned_address</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">address</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-147" name="l-147"></a><span class="linenos">147</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-148" name="l-148"></a><span class="linenos">148</span><span class="w">        </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;Wrong address returned!&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-149" name="l-149"></a><span class="linenos">149</span><span class="w">        </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Expected &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-150" name="l-150"></a><span class="linenos">150</span><span class="w">        </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="kr">String</span><span class="p">(</span><span class="n">address</span><span class="p">));</span>
</div><div class="line"><a id="l-151" name="l-151"></a><span class="linenos">151</span><span class="w">        </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot; Got &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-152" name="l-152"></a><span class="linenos">152</span><span class="w">        </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="kr">String</span><span class="p">(</span><span class="n">returned_address</span><span class="p">));</span>
</div><div class="line"><a id="l-153" name="l-153"></a><span class="linenos">153</span><span class="w">        </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="kr">String</span><span class="p">(</span><span class="n">resp_buffer</span><span class="p">));</span>
</div><div class="line"><a id="l-154" name="l-154"></a><span class="linenos">154</span><span class="w">      </span><span class="p">}</span>
</div><div class="line"><a id="l-155" name="l-155"></a><span class="linenos">155</span><span class="w">      </span><span class="n">success</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-156" name="l-156"></a><span class="linenos">156</span><span class="w">      </span><span class="n">return_result</span><span class="p">.</span><span class="n">addressMatch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-157" name="l-157"></a><span class="linenos">157</span><span class="w">      </span><span class="k">break</span><span class="p">;</span>
</div><div class="line"><a id="l-158" name="l-158"></a><span class="linenos">158</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-159" name="l-159"></a><span class="linenos">159</span>
</div><div class="line"><a id="l-160" name="l-160"></a><span class="linenos">160</span><span class="w">    </span><span class="c1">// check the crc, break if it&#39;s incorrect</span>
</div><div class="line"><a id="l-161" name="l-161"></a><span class="linenos">161</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">verify_crc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-162" name="l-162"></a><span class="linenos">162</span><span class="w">      </span><span class="kr">bool</span><span class="w"> </span><span class="n">crcMatch</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">verifyCRC</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">);</span>
</div><div class="line"><a id="l-163" name="l-163"></a><span class="linenos">163</span><span class="w">      </span><span class="n">data_bytes_read</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_bytes_read</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
</div><div class="line"><a id="l-164" name="l-164"></a><span class="linenos">164</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">crcMatch</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-165" name="l-165"></a><span class="linenos">165</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;CRC valid&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
</div><div class="line"><a id="l-166" name="l-166"></a><span class="linenos">166</span><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-167" name="l-167"></a><span class="linenos">167</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;CRC check failed!&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
</div><div class="line"><a id="l-168" name="l-168"></a><span class="linenos">168</span><span class="w">        </span><span class="n">return_result</span><span class="p">.</span><span class="n">crcMatch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-169" name="l-169"></a><span class="linenos">169</span><span class="w">        </span><span class="n">success</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-170" name="l-170"></a><span class="linenos">170</span><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</div><div class="line"><a id="l-171" name="l-171"></a><span class="linenos">171</span><span class="w">      </span><span class="p">}</span>
</div><div class="line"><a id="l-172" name="l-172"></a><span class="linenos">172</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-173" name="l-173"></a><span class="linenos">173</span>
</div><div class="line"><a id="l-174" name="l-174"></a><span class="linenos">174</span><span class="w">    </span><span class="kr">bool</span><span class="w">    </span><span class="n">gotResults</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-175" name="l-175"></a><span class="linenos">175</span><span class="w">    </span><span class="kr">char</span><span class="w">    </span><span class="n">float_buffer</span><span class="p">[</span><span class="n">max_sdi_digits</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="sc">&#39;\0&#39;</span><span class="p">};</span>
</div><div class="line"><a id="l-176" name="l-176"></a><span class="linenos">176</span><span class="w">    </span><span class="kr">char</span><span class="o">*</span><span class="w">   </span><span class="n">dec_pl</span><span class="w">                       </span><span class="o">=</span><span class="w"> </span><span class="n">float_buffer</span><span class="p">;</span>
</div><div class="line"><a id="l-177" name="l-177"></a><span class="linenos">177</span><span class="w">    </span><span class="kr">uint8_t</span><span class="w"> </span><span class="n">fb_pos</span><span class="w">                       </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">  </span><span class="c1">// start at start of buffer</span>
</div><div class="line"><a id="l-178" name="l-178"></a><span class="linenos">178</span><span class="w">    </span><span class="kr">bool</span><span class="w">    </span><span class="n">finished_last_number</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-179" name="l-179"></a><span class="linenos">179</span><span class="w">    </span><span class="c1">// iterate through the char array and to check results</span>
</div><div class="line"><a id="l-180" name="l-180"></a><span class="linenos">180</span><span class="w">    </span><span class="c1">// NOTE: start at 1 since we already looked at the address!</span>
</div><div class="line"><a id="l-181" name="l-181"></a><span class="linenos">181</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">data_bytes_read</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-182" name="l-182"></a><span class="linenos">182</span><span class="w">      </span><span class="c1">// Get the character at position</span>
</div><div class="line"><a id="l-183" name="l-183"></a><span class="linenos">183</span><span class="w">      </span><span class="kr">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resp_buffer</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</div><div class="line"><a id="l-184" name="l-184"></a><span class="linenos">184</span><span class="w">      </span><span class="c1">// Serial.print(i);</span>
</div><div class="line"><a id="l-185" name="l-185"></a><span class="linenos">185</span><span class="w">      </span><span class="c1">// Serial.print(&quot; of &quot;);</span>
</div><div class="line"><a id="l-186" name="l-186"></a><span class="linenos">186</span><span class="w">      </span><span class="c1">// Serial.print(data_bytes_read);</span>
</div><div class="line"><a id="l-187" name="l-187"></a><span class="linenos">187</span><span class="w">      </span><span class="c1">// Serial.print(&quot; &#39;&quot;);</span>
</div><div class="line"><a id="l-188" name="l-188"></a><span class="linenos">188</span><span class="w">      </span><span class="c1">// Serial.print(c);</span>
</div><div class="line"><a id="l-189" name="l-189"></a><span class="linenos">189</span><span class="w">      </span><span class="c1">// Serial.println(&quot;&#39;&quot;);</span>
</div><div class="line"><a id="l-190" name="l-190"></a><span class="linenos">190</span><span class="w">      </span><span class="c1">// if we didn&#39;t get something number-esque or we&#39;re at the end of the buffer,</span>
</div><div class="line"><a id="l-191" name="l-191"></a><span class="linenos">191</span><span class="w">      </span><span class="c1">// assume the last number finished and parse it</span>
</div><div class="line"><a id="l-192" name="l-192"></a><span class="linenos">192</span><span class="w">      </span><span class="c1">//(c != &#39;-&#39; &amp;&amp; (c &lt; &#39;0&#39; || c &gt; &#39;9&#39;) &amp;&amp; c != &#39;.&#39;)</span>
</div><div class="line"><a id="l-193" name="l-193"></a><span class="linenos">193</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;-&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;9&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-194" name="l-194"></a><span class="linenos">194</span><span class="w">        </span><span class="c1">// if there&#39;s a number, a decimal, or a negative sign next in the</span>
</div><div class="line"><a id="l-195" name="l-195"></a><span class="linenos">195</span><span class="w">        </span><span class="c1">// buffer, add it to the float buffer.</span>
</div><div class="line"><a id="l-196" name="l-196"></a><span class="linenos">196</span><span class="w">        </span><span class="n">float_buffer</span><span class="p">[</span><span class="n">fb_pos</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
</div><div class="line"><a id="l-197" name="l-197"></a><span class="linenos">197</span><span class="w">        </span><span class="n">fb_pos</span><span class="o">++</span><span class="p">;</span>
</div><div class="line"><a id="l-198" name="l-198"></a><span class="linenos">198</span><span class="w">        </span><span class="n">float_buffer</span><span class="p">[</span><span class="n">fb_pos</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// null terminate the buffer</span>
</div><div class="line"><a id="l-199" name="l-199"></a><span class="linenos">199</span><span class="w">        </span><span class="n">finished_last_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-200" name="l-200"></a><span class="linenos">200</span><span class="w">        </span><span class="c1">// Serial.print(&quot;Added to float buffer, currently: &#39;&quot;);</span>
</div><div class="line"><a id="l-201" name="l-201"></a><span class="linenos">201</span><span class="w">        </span><span class="c1">// Serial.print(float_buffer);</span>
</div><div class="line"><a id="l-202" name="l-202"></a><span class="linenos">202</span><span class="w">        </span><span class="c1">// Serial.println(&quot;&#39;&quot;);</span>
</div><div class="line"><a id="l-203" name="l-203"></a><span class="linenos">203</span><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-204" name="l-204"></a><span class="linenos">204</span><span class="w">        </span><span class="c1">// Serial.println(&quot;Non Numeric&quot;);</span>
</div><div class="line"><a id="l-205" name="l-205"></a><span class="linenos">205</span><span class="w">        </span><span class="n">finished_last_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-206" name="l-206"></a><span class="linenos">206</span><span class="w">      </span><span class="p">}</span>
</div><div class="line"><a id="l-207" name="l-207"></a><span class="linenos">207</span><span class="w">      </span><span class="c1">// if we&#39;ve gotten to the end of a number or the end of the buffer, parse the</span>
</div><div class="line"><a id="l-208" name="l-208"></a><span class="linenos">208</span><span class="w">      </span><span class="c1">// character</span>
</div><div class="line"><a id="l-209" name="l-209"></a><span class="linenos">209</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">finished_last_number</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">data_bytes_read</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</div><div class="line"><a id="l-210" name="l-210"></a><span class="linenos">210</span><span class="w">          </span><span class="n">strnlen</span><span class="p">(</span><span class="n">float_buffer</span><span class="p">,</span><span class="w"> </span><span class="n">max_sdi_digits</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-211" name="l-211"></a><span class="linenos">211</span><span class="w">        </span><span class="kr">float</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atof</span><span class="p">(</span><span class="n">float_buffer</span><span class="p">);</span>
</div><div class="line"><a id="l-212" name="l-212"></a><span class="linenos">212</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-213" name="l-213"></a><span class="linenos">213</span><span class="w">          </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Result &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-214" name="l-214"></a><span class="linenos">214</span><span class="w">          </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">resultsReceived</span><span class="p">);</span>
</div><div class="line"><a id="l-215" name="l-215"></a><span class="linenos">215</span><span class="w">          </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Raw value: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-216" name="l-216"></a><span class="linenos">216</span><span class="w">          </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">float_buffer</span><span class="p">);</span>
</div><div class="line"><a id="l-217" name="l-217"></a><span class="linenos">217</span><span class="w">          </span><span class="n">dec_pl</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="n">strchr</span><span class="p">(</span><span class="n">float_buffer</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="p">);</span>
</div><div class="line"><a id="l-218" name="l-218"></a><span class="linenos">218</span><span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">len_post_dec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-219" name="l-219"></a><span class="linenos">219</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dec_pl</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">len_post_dec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strnlen</span><span class="p">(</span><span class="n">dec_pl</span><span class="p">,</span><span class="w"> </span><span class="n">max_sdi_digits</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</div><div class="line"><a id="l-220" name="l-220"></a><span class="linenos">220</span><span class="w">          </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Len after decimal: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-221" name="l-221"></a><span class="linenos">221</span><span class="w">          </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">len_post_dec</span><span class="p">);</span>
</div><div class="line"><a id="l-222" name="l-222"></a><span class="linenos">222</span><span class="w">          </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Parsed value: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-223" name="l-223"></a><span class="linenos">223</span><span class="w">          </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="kr">String</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">len_post_dec</span><span class="p">));</span>
</div><div class="line"><a id="l-224" name="l-224"></a><span class="linenos">224</span><span class="w">        </span><span class="p">}</span>
</div><div class="line"><a id="l-225" name="l-225"></a><span class="linenos">225</span><span class="w">        </span><span class="c1">// add how many results we have</span>
</div><div class="line"><a id="l-226" name="l-226"></a><span class="linenos">226</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-9999</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-227" name="l-227"></a><span class="linenos">227</span><span class="w">          </span><span class="n">gotResults</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-228" name="l-228"></a><span class="linenos">228</span><span class="w">          </span><span class="n">resultsReceived</span><span class="o">++</span><span class="p">;</span>
</div><div class="line"><a id="l-229" name="l-229"></a><span class="linenos">229</span><span class="w">        </span><span class="p">}</span>
</div><div class="line"><a id="l-230" name="l-230"></a><span class="linenos">230</span><span class="w">        </span><span class="c1">// check for a failure error code at the end</span>
</div><div class="line"><a id="l-231" name="l-231"></a><span class="linenos">231</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error_result_number</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-232" name="l-232"></a><span class="linenos">232</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resultsReceived</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">error_result_number</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">no_error_value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-233" name="l-233"></a><span class="linenos">233</span><span class="w">            </span><span class="n">success</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-234" name="l-234"></a><span class="linenos">234</span><span class="w">            </span><span class="n">return_result</span><span class="p">.</span><span class="n">errorCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-235" name="l-235"></a><span class="linenos">235</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-236" name="l-236"></a><span class="linenos">236</span><span class="w">              </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Got a failure code of &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-237" name="l-237"></a><span class="linenos">237</span><span class="w">              </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="kr">String</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">strnlen</span><span class="p">(</span><span class="n">dec_pl</span><span class="p">,</span><span class="w"> </span><span class="n">max_sdi_digits</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
</div><div class="line"><a id="l-238" name="l-238"></a><span class="linenos">238</span><span class="w">            </span><span class="p">}</span>
</div><div class="line"><a id="l-239" name="l-239"></a><span class="linenos">239</span><span class="w">          </span><span class="p">}</span>
</div><div class="line"><a id="l-240" name="l-240"></a><span class="linenos">240</span><span class="w">        </span><span class="p">}</span>
</div><div class="line"><a id="l-241" name="l-241"></a><span class="linenos">241</span>
</div><div class="line"><a id="l-242" name="l-242"></a><span class="linenos">242</span><span class="w">        </span><span class="c1">// empty the buffer</span>
</div><div class="line"><a id="l-243" name="l-243"></a><span class="linenos">243</span><span class="w">        </span><span class="n">float_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</div><div class="line"><a id="l-244" name="l-244"></a><span class="linenos">244</span><span class="w">        </span><span class="n">fb_pos</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-245" name="l-245"></a><span class="linenos">245</span><span class="w">      </span><span class="p">}</span>
</div><div class="line"><a id="l-246" name="l-246"></a><span class="linenos">246</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-247" name="l-247"></a><span class="linenos">247</span>
</div><div class="line"><a id="l-248" name="l-248"></a><span class="linenos">248</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">gotResults</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-249" name="l-249"></a><span class="linenos">249</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-250" name="l-250"></a><span class="linenos">250</span><span class="w">        </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">((</span><span class="s">&quot;  No results received, will not continue requests!&quot;</span><span class="p">));</span>
</div><div class="line"><a id="l-251" name="l-251"></a><span class="linenos">251</span><span class="w">      </span><span class="p">}</span>
</div><div class="line"><a id="l-252" name="l-252"></a><span class="linenos">252</span><span class="w">      </span><span class="k">break</span><span class="p">;</span>
</div><div class="line"><a id="l-253" name="l-253"></a><span class="linenos">253</span><span class="w">    </span><span class="p">}</span><span class="w">  </span><span class="c1">// don&#39;t do another loop if we got nothing</span>
</div><div class="line"><a id="l-254" name="l-254"></a><span class="linenos">254</span>
</div><div class="line"><a id="l-255" name="l-255"></a><span class="linenos">255</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-256" name="l-256"></a><span class="linenos">256</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Total Results Received: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-257" name="l-257"></a><span class="linenos">257</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">resultsReceived</span><span class="p">);</span>
</div><div class="line"><a id="l-258" name="l-258"></a><span class="linenos">258</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Remaining: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-259" name="l-259"></a><span class="linenos">259</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">resultsExpected</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">resultsReceived</span><span class="p">);</span>
</div><div class="line"><a id="l-260" name="l-260"></a><span class="linenos">260</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-261" name="l-261"></a><span class="linenos">261</span>
</div><div class="line"><a id="l-262" name="l-262"></a><span class="linenos">262</span><span class="w">    </span><span class="n">cmd_number</span><span class="o">++</span><span class="p">;</span>
</div><div class="line"><a id="l-263" name="l-263"></a><span class="linenos">263</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-264" name="l-264"></a><span class="linenos">264</span>
</div><div class="line"><a id="l-265" name="l-265"></a><span class="linenos">265</span><span class="w">  </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">clearBuffer</span><span class="p">();</span>
</div><div class="line"><a id="l-266" name="l-266"></a><span class="linenos">266</span>
</div><div class="line"><a id="l-267" name="l-267"></a><span class="linenos">267</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-268" name="l-268"></a><span class="linenos">268</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;After &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-269" name="l-269"></a><span class="linenos">269</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">cmd_number</span><span class="p">);</span>
</div><div class="line"><a id="l-270" name="l-270"></a><span class="linenos">270</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot; data commands got &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-271" name="l-271"></a><span class="linenos">271</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">resultsReceived</span><span class="p">);</span>
</div><div class="line"><a id="l-272" name="l-272"></a><span class="linenos">272</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot; results of the expected &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-273" name="l-273"></a><span class="linenos">273</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">resultsExpected</span><span class="p">);</span>
</div><div class="line"><a id="l-274" name="l-274"></a><span class="linenos">274</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot; expected. This is a &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-275" name="l-275"></a><span class="linenos">275</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">resultsReceived</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">resultsExpected</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;success.&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;failure.&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-276" name="l-276"></a><span class="linenos">276</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-277" name="l-277"></a><span class="linenos">277</span>
</div><div class="line"><a id="l-278" name="l-278"></a><span class="linenos">278</span><span class="w">  </span><span class="n">success</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="n">resultsReceived</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">resultsExpected</span><span class="p">;</span>
</div><div class="line"><a id="l-279" name="l-279"></a><span class="linenos">279</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">resultsReceived</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resultsReceived</span><span class="p">;</span>
</div><div class="line"><a id="l-280" name="l-280"></a><span class="linenos">280</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">maxDataCommand</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">cmd_number</span><span class="p">;</span>
</div><div class="line"><a id="l-281" name="l-281"></a><span class="linenos">281</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">success</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">success</span><span class="p">;</span>
</div><div class="line"><a id="l-282" name="l-282"></a><span class="linenos">282</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">return_result</span><span class="p">;</span>
</div><div class="line"><a id="l-283" name="l-283"></a><span class="linenos">283</span><span class="p">}</span>
</div><div class="line"><a id="l-284" name="l-284"></a><span class="linenos">284</span>
</div><div class="line"><a id="l-285" name="l-285"></a><span class="linenos">285</span><span class="n">startMeasurementResult</span><span class="w"> </span><span class="n">startMeasurement</span><span class="p">(</span><span class="kr">char</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="kr">bool</span><span class="w"> </span><span class="n">is_concurrent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">,</span>
</div><div class="line"><a id="l-286" name="l-286"></a><span class="linenos">286</span><span class="w">                                        </span><span class="kr">bool</span><span class="w"> </span><span class="n">request_crc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">,</span><span class="w"> </span><span class="kr">String</span><span class="w"> </span><span class="n">meas_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span>
</div><div class="line"><a id="l-287" name="l-287"></a><span class="linenos">287</span><span class="w">                                        </span><span class="kr">bool</span><span class="w"> </span><span class="n">printCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-288" name="l-288"></a><span class="linenos">288</span><span class="w">  </span><span class="c1">// Create the return struct</span>
</div><div class="line"><a id="l-289" name="l-289"></a><span class="linenos">289</span><span class="w">  </span><span class="n">startMeasurementResult</span><span class="w"> </span><span class="n">return_result</span><span class="p">;</span>
</div><div class="line"><a id="l-290" name="l-290"></a><span class="linenos">290</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">returned_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
</div><div class="line"><a id="l-291" name="l-291"></a><span class="linenos">291</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">meas_time_s</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-292" name="l-292"></a><span class="linenos">292</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">numberResults</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-293" name="l-293"></a><span class="linenos">293</span>
</div><div class="line"><a id="l-294" name="l-294"></a><span class="linenos">294</span><span class="w">  </span><span class="kr">String</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
</div><div class="line"><a id="l-295" name="l-295"></a><span class="linenos">295</span><span class="w">  </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">address</span><span class="p">;</span><span class="w">                    </span><span class="c1">// All commands start with the address</span>
</div><div class="line"><a id="l-296" name="l-296"></a><span class="linenos">296</span><span class="w">  </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">is_concurrent</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;M&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1">// C for concurrent, M for standard</span>
</div><div class="line"><a id="l-297" name="l-297"></a><span class="linenos">297</span><span class="w">  </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">request_crc</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w">     </span><span class="c1">// add an additional C to request a CRC</span>
</div><div class="line"><a id="l-298" name="l-298"></a><span class="linenos">298</span><span class="w">  </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">meas_type</span><span class="p">;</span><span class="w">                  </span><span class="c1">// Measurement type, &quot;&quot; or 0-9</span>
</div><div class="line"><a id="l-299" name="l-299"></a><span class="linenos">299</span><span class="w">  </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;!&quot;</span><span class="p">;</span><span class="w">                        </span><span class="c1">// All commands end with &quot;!&quot;</span>
</div><div class="line"><a id="l-300" name="l-300"></a><span class="linenos">300</span><span class="w">  </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">sendCommand</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">wake_delay</span><span class="p">);</span>
</div><div class="line"><a id="l-301" name="l-301"></a><span class="linenos">301</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-302" name="l-302"></a><span class="linenos">302</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;&gt;&gt;&gt;&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-303" name="l-303"></a><span class="linenos">303</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>
</div><div class="line"><a id="l-304" name="l-304"></a><span class="linenos">304</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-305" name="l-305"></a><span class="linenos">305</span>
</div><div class="line"><a id="l-306" name="l-306"></a><span class="linenos">306</span><span class="w">  </span><span class="c1">// wait for acknowlegement with format [address][ttt (3 char, seconds)][number of</span>
</div><div class="line"><a id="l-307" name="l-307"></a><span class="linenos">307</span><span class="w">  </span><span class="c1">// measurments available, 0-9]</span>
</div><div class="line"><a id="l-308" name="l-308"></a><span class="linenos">308</span><span class="w">  </span><span class="kr">String</span><span class="w"> </span><span class="n">sdiResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mySDI12</span><span class="p">.</span><span class="nf">readStringUntil</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
</div><div class="line"><a id="l-309" name="l-309"></a><span class="linenos">309</span><span class="w">  </span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">trim</span><span class="p">();</span>
</div><div class="line"><a id="l-310" name="l-310"></a><span class="linenos">310</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-311" name="l-311"></a><span class="linenos">311</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;&lt;&lt;&lt;&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-312" name="l-312"></a><span class="linenos">312</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">);</span>
</div><div class="line"><a id="l-313" name="l-313"></a><span class="linenos">313</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-314" name="l-314"></a><span class="linenos">314</span><span class="w">  </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">clearBuffer</span><span class="p">();</span>
</div><div class="line"><a id="l-315" name="l-315"></a><span class="linenos">315</span>
</div><div class="line"><a id="l-316" name="l-316"></a><span class="linenos">316</span><span class="w">  </span><span class="c1">// check the address, return if it&#39;s incorrect</span>
</div><div class="line"><a id="l-317" name="l-317"></a><span class="linenos">317</span><span class="w">  </span><span class="kr">String</span><span class="w"> </span><span class="n">returned_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</div><div class="line"><a id="l-318" name="l-318"></a><span class="linenos">318</span><span class="w">  </span><span class="kr">char</span><span class="w">   </span><span class="n">ret_addr_array</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</div><div class="line"><a id="l-319" name="l-319"></a><span class="linenos">319</span><span class="w">  </span><span class="n">returned_address</span><span class="p">.</span><span class="n">toCharArray</span><span class="p">(</span><span class="n">ret_addr_array</span><span class="p">,</span><span class="w"> </span><span class="kr">sizeof</span><span class="p">(</span><span class="n">ret_addr_array</span><span class="p">));</span>
</div><div class="line"><a id="l-320" name="l-320"></a><span class="linenos">320</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">returned_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ret_addr_array</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</div><div class="line"><a id="l-321" name="l-321"></a><span class="linenos">321</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">returned_address</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kr">String</span><span class="p">(</span><span class="n">address</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-322" name="l-322"></a><span class="linenos">322</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-323" name="l-323"></a><span class="linenos">323</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;Wrong address returned!&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-324" name="l-324"></a><span class="linenos">324</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Expected &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-325" name="l-325"></a><span class="linenos">325</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="kr">String</span><span class="p">(</span><span class="n">address</span><span class="p">));</span>
</div><div class="line"><a id="l-326" name="l-326"></a><span class="linenos">326</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot; Got &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-327" name="l-327"></a><span class="linenos">327</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">returned_address</span><span class="p">);</span>
</div><div class="line"><a id="l-328" name="l-328"></a><span class="linenos">328</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-329" name="l-329"></a><span class="linenos">329</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">return_result</span><span class="p">;</span>
</div><div class="line"><a id="l-330" name="l-330"></a><span class="linenos">330</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-331" name="l-331"></a><span class="linenos">331</span>
</div><div class="line"><a id="l-332" name="l-332"></a><span class="linenos">332</span><span class="w">  </span><span class="c1">// find out how long we have to wait (in seconds).</span>
</div><div class="line"><a id="l-333" name="l-333"></a><span class="linenos">333</span><span class="w">  </span><span class="kr">uint8_t</span><span class="w"> </span><span class="n">meas_time_s</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">).</span><span class="n">toInt</span><span class="p">();</span>
</div><div class="line"><a id="l-334" name="l-334"></a><span class="linenos">334</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">meas_time_s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">meas_time_s</span><span class="p">;</span>
</div><div class="line"><a id="l-335" name="l-335"></a><span class="linenos">335</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-336" name="l-336"></a><span class="linenos">336</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;expected measurement time: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-337" name="l-337"></a><span class="linenos">337</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">meas_time_s</span><span class="p">);</span>
</div><div class="line"><a id="l-338" name="l-338"></a><span class="linenos">338</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot; s, &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-339" name="l-339"></a><span class="linenos">339</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-340" name="l-340"></a><span class="linenos">340</span>
</div><div class="line"><a id="l-341" name="l-341"></a><span class="linenos">341</span><span class="w">  </span><span class="c1">// Set up the number of results to expect</span>
</div><div class="line"><a id="l-342" name="l-342"></a><span class="linenos">342</span><span class="w">  </span><span class="kr">int</span><span class="w"> </span><span class="n">numResults</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">4</span><span class="p">).</span><span class="n">toInt</span><span class="p">();</span>
</div><div class="line"><a id="l-343" name="l-343"></a><span class="linenos">343</span><span class="w">  </span><span class="n">return_result</span><span class="p">.</span><span class="n">numberResults</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numResults</span><span class="p">;</span>
</div><div class="line"><a id="l-344" name="l-344"></a><span class="linenos">344</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-345" name="l-345"></a><span class="linenos">345</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Number Results: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-346" name="l-346"></a><span class="linenos">346</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">numResults</span><span class="p">);</span>
</div><div class="line"><a id="l-347" name="l-347"></a><span class="linenos">347</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-348" name="l-348"></a><span class="linenos">348</span>
</div><div class="line"><a id="l-349" name="l-349"></a><span class="linenos">349</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">return_result</span><span class="p">;</span>
</div><div class="line"><a id="l-350" name="l-350"></a><span class="linenos">350</span><span class="p">}</span>
</div><div class="line"><a id="l-351" name="l-351"></a><span class="linenos">351</span>
</div><div class="line"><a id="l-352" name="l-352"></a><span class="linenos">352</span><span class="kr">uint32_t</span><span class="w"> </span><span class="n">takeMeasurement</span><span class="p">(</span><span class="kr">char</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="kr">bool</span><span class="w"> </span><span class="n">request_crc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">false</span><span class="p">,</span><span class="w"> </span><span class="kr">String</span><span class="w"> </span><span class="n">meas_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span>
</div><div class="line"><a id="l-353" name="l-353"></a><span class="linenos">353</span><span class="w">                         </span><span class="kr">bool</span><span class="w"> </span><span class="n">printCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-354" name="l-354"></a><span class="linenos">354</span><span class="w">  </span><span class="n">startMeasurementResult</span><span class="w"> </span><span class="n">startResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">startMeasurement</span><span class="p">(</span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="kr">false</span><span class="p">,</span><span class="w"> </span><span class="n">request_crc</span><span class="p">,</span>
</div><div class="line"><a id="l-355" name="l-355"></a><span class="linenos">355</span><span class="w">                                                        </span><span class="n">meas_type</span><span class="p">,</span><span class="w"> </span><span class="n">printCommands</span><span class="p">);</span>
</div><div class="line"><a id="l-356" name="l-356"></a><span class="linenos">356</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">startResult</span><span class="p">.</span><span class="n">numberResults</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</div><div class="line"><a id="l-357" name="l-357"></a><span class="linenos">357</span>
</div><div class="line"><a id="l-358" name="l-358"></a><span class="linenos">358</span><span class="w">  </span><span class="kr">uint32_t</span><span class="w"> </span><span class="n">timerStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">millis</span><span class="p">();</span>
</div><div class="line"><a id="l-359" name="l-359"></a><span class="linenos">359</span><span class="w">  </span><span class="kr">uint32_t</span><span class="w"> </span><span class="n">measTime</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
</div><div class="line"><a id="l-360" name="l-360"></a><span class="linenos">360</span><span class="w">  </span><span class="c1">// wait up to 1 second longer than the specified return time</span>
</div><div class="line"><a id="l-361" name="l-361"></a><span class="linenos">361</span><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="nf">millis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">timerStart</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span>
</div><div class="line"><a id="l-362" name="l-362"></a><span class="linenos">362</span><span class="w">         </span><span class="p">(</span><span class="kr">static_cast</span><span class="o">&lt;</span><span class="kr">uint32_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">startResult</span><span class="p">.</span><span class="n">meas_time_s</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-363" name="l-363"></a><span class="linenos">363</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mySDI12</span><span class="p">.</span><span class="nf">available</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-364" name="l-364"></a><span class="linenos">364</span><span class="w">      </span><span class="k">break</span><span class="p">;</span>
</div><div class="line"><a id="l-365" name="l-365"></a><span class="linenos">365</span><span class="w">    </span><span class="p">}</span><span class="w">  </span><span class="c1">// sensor can interrupt us to let us know it is done early</span>
</div><div class="line"><a id="l-366" name="l-366"></a><span class="linenos">366</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-367" name="l-367"></a><span class="linenos">367</span><span class="w">  </span><span class="n">measTime</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="nf">millis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">timerStart</span><span class="p">;</span>
</div><div class="line"><a id="l-368" name="l-368"></a><span class="linenos">368</span><span class="w">  </span><span class="kr">String</span><span class="w"> </span><span class="n">interrupt_response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mySDI12</span><span class="p">.</span><span class="nf">readStringUntil</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
</div><div class="line"><a id="l-369" name="l-369"></a><span class="linenos">369</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-370" name="l-370"></a><span class="linenos">370</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;&lt;&lt;&lt;&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-371" name="l-371"></a><span class="linenos">371</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">interrupt_response</span><span class="p">);</span>
</div><div class="line"><a id="l-372" name="l-372"></a><span class="linenos">372</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Completed after &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-373" name="l-373"></a><span class="linenos">373</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">measTime</span><span class="p">);</span>
</div><div class="line"><a id="l-374" name="l-374"></a><span class="linenos">374</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot; ms&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-375" name="l-375"></a><span class="linenos">375</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-376" name="l-376"></a><span class="linenos">376</span>
</div><div class="line"><a id="l-377" name="l-377"></a><span class="linenos">377</span><span class="w">  </span><span class="c1">// if we got results, return the measurement time, else -1</span>
</div><div class="line"><a id="l-378" name="l-378"></a><span class="linenos">378</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">getResults</span><span class="p">(</span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="n">startResult</span><span class="p">.</span><span class="n">numberResults</span><span class="p">,</span><span class="w"> </span><span class="n">request_crc</span><span class="p">,</span><span class="w"> </span><span class="n">printCommands</span><span class="p">)</span>
</div><div class="line"><a id="l-379" name="l-379"></a><span class="linenos">379</span><span class="w">        </span><span class="p">.</span><span class="n">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-380" name="l-380"></a><span class="linenos">380</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">measTime</span><span class="p">;</span>
</div><div class="line"><a id="l-381" name="l-381"></a><span class="linenos">381</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-382" name="l-382"></a><span class="linenos">382</span>
</div><div class="line"><a id="l-383" name="l-383"></a><span class="linenos">383</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
</div><div class="line"><a id="l-384" name="l-384"></a><span class="linenos">384</span><span class="p">}</span>
</div><div class="line"><a id="l-385" name="l-385"></a><span class="linenos">385</span>
</div><div class="line"><a id="l-386" name="l-386"></a><span class="linenos">386</span><span class="c1">// this checks for activity at a particular address</span>
</div><div class="line"><a id="l-387" name="l-387"></a><span class="linenos">387</span><span class="c1">// expects a char, &#39;0&#39;-&#39;9&#39;, &#39;a&#39;-&#39;z&#39;, or &#39;A&#39;-&#39;Z&#39;</span>
</div><div class="line"><a id="l-388" name="l-388"></a><span class="linenos">388</span><span class="kr">bool</span><span class="w"> </span><span class="n">checkActive</span><span class="p">(</span><span class="kr">char</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="kr">int8_t</span><span class="w"> </span><span class="n">numPings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kr">bool</span><span class="w"> </span><span class="n">printCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-389" name="l-389"></a><span class="linenos">389</span><span class="w">  </span><span class="kr">String</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
</div><div class="line"><a id="l-390" name="l-390"></a><span class="linenos">390</span><span class="w">  </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="kr">char</span><span class="p">)</span><span class="n">address</span><span class="p">;</span><span class="w">  </span><span class="c1">// sends basic &#39;acknowledge&#39; command [address][!]</span>
</div><div class="line"><a id="l-391" name="l-391"></a><span class="linenos">391</span><span class="w">  </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;!&quot;</span><span class="p">;</span>
</div><div class="line"><a id="l-392" name="l-392"></a><span class="linenos">392</span>
</div><div class="line"><a id="l-393" name="l-393"></a><span class="linenos">393</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kr">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numPings</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// goes through three rapid contact attempts</span>
</div><div class="line"><a id="l-394" name="l-394"></a><span class="linenos">394</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-395" name="l-395"></a><span class="linenos">395</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;&gt;&gt;&gt;&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-396" name="l-396"></a><span class="linenos">396</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>
</div><div class="line"><a id="l-397" name="l-397"></a><span class="linenos">397</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-398" name="l-398"></a><span class="linenos">398</span><span class="w">    </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">sendCommand</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">wake_delay</span><span class="p">);</span>
</div><div class="line"><a id="l-399" name="l-399"></a><span class="linenos">399</span>
</div><div class="line"><a id="l-400" name="l-400"></a><span class="linenos">400</span><span class="w">    </span><span class="c1">// the sensor should just return its address</span>
</div><div class="line"><a id="l-401" name="l-401"></a><span class="linenos">401</span><span class="w">    </span><span class="kr">String</span><span class="w"> </span><span class="n">sdiResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mySDI12</span><span class="p">.</span><span class="nf">readStringUntil</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
</div><div class="line"><a id="l-402" name="l-402"></a><span class="linenos">402</span><span class="w">    </span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">trim</span><span class="p">();</span>
</div><div class="line"><a id="l-403" name="l-403"></a><span class="linenos">403</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-404" name="l-404"></a><span class="linenos">404</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;&lt;&lt;&lt;&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-405" name="l-405"></a><span class="linenos">405</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">);</span>
</div><div class="line"><a id="l-406" name="l-406"></a><span class="linenos">406</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-407" name="l-407"></a><span class="linenos">407</span><span class="w">    </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">clearBuffer</span><span class="p">();</span>
</div><div class="line"><a id="l-408" name="l-408"></a><span class="linenos">408</span>
</div><div class="line"><a id="l-409" name="l-409"></a><span class="linenos">409</span><span class="w">    </span><span class="c1">// check the address, return false if it&#39;s incorrect</span>
</div><div class="line"><a id="l-410" name="l-410"></a><span class="linenos">410</span><span class="w">    </span><span class="kr">String</span><span class="w"> </span><span class="n">returned_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</div><div class="line"><a id="l-411" name="l-411"></a><span class="linenos">411</span><span class="w">    </span><span class="kr">char</span><span class="w">   </span><span class="n">ret_addr_array</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</div><div class="line"><a id="l-412" name="l-412"></a><span class="linenos">412</span><span class="w">    </span><span class="n">returned_address</span><span class="p">.</span><span class="n">toCharArray</span><span class="p">(</span><span class="n">ret_addr_array</span><span class="p">,</span><span class="w"> </span><span class="kr">sizeof</span><span class="p">(</span><span class="n">ret_addr_array</span><span class="p">));</span>
</div><div class="line"><a id="l-413" name="l-413"></a><span class="linenos">413</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">returned_address</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kr">String</span><span class="p">(</span><span class="n">address</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</div><div class="line"><a id="l-414" name="l-414"></a><span class="linenos">414</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-415" name="l-415"></a><span class="linenos">415</span><span class="w">  </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">clearBuffer</span><span class="p">();</span>
</div><div class="line"><a id="l-416" name="l-416"></a><span class="linenos">416</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span>
</div><div class="line"><a id="l-417" name="l-417"></a><span class="linenos">417</span><span class="p">}</span>
</div><div class="line"><a id="l-418" name="l-418"></a><span class="linenos">418</span>
</div><div class="line"><a id="l-419" name="l-419"></a><span class="linenos">419</span><span class="cm">/**</span>
</div><div class="line"><a id="l-420" name="l-420"></a><span class="linenos">420</span><span class="cm"> * @brief gets identification information from a sensor, and prints it to the serial</span>
</div><div class="line"><a id="l-421" name="l-421"></a><span class="linenos">421</span><span class="cm"> * port</span>
</div><div class="line"><a id="l-422" name="l-422"></a><span class="linenos">422</span><span class="cm"> *</span>
</div><div class="line"><a id="l-423" name="l-423"></a><span class="linenos">423</span><span class="cm"> * @param i a character between &#39;0&#39;-&#39;9&#39;, &#39;a&#39;-&#39;z&#39;, or &#39;A&#39;-&#39;Z&#39;.</span>
</div><div class="line"><a id="l-424" name="l-424"></a><span class="linenos">424</span><span class="cm"> * @param printCommands true to print the raw output and input from the command</span>
</div><div class="line"><a id="l-425" name="l-425"></a><span class="linenos">425</span><span class="cm"> */</span>
</div><div class="line"><a id="l-426" name="l-426"></a><span class="linenos">426</span><span class="kr">bool</span><span class="w"> </span><span class="n">printInfo</span><span class="p">(</span><span class="kr">char</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kr">bool</span><span class="w"> </span><span class="n">printCommands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-427" name="l-427"></a><span class="linenos">427</span><span class="w">  </span><span class="kr">String</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
</div><div class="line"><a id="l-428" name="l-428"></a><span class="linenos">428</span><span class="w">  </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="kr">char</span><span class="p">)</span><span class="n">i</span><span class="p">;</span>
</div><div class="line"><a id="l-429" name="l-429"></a><span class="linenos">429</span><span class="w">  </span><span class="n">command</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;I!&quot;</span><span class="p">;</span>
</div><div class="line"><a id="l-430" name="l-430"></a><span class="linenos">430</span><span class="w">  </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">sendCommand</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">wake_delay</span><span class="p">);</span>
</div><div class="line"><a id="l-431" name="l-431"></a><span class="linenos">431</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-432" name="l-432"></a><span class="linenos">432</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;&gt;&gt;&gt;&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-433" name="l-433"></a><span class="linenos">433</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>
</div><div class="line"><a id="l-434" name="l-434"></a><span class="linenos">434</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-435" name="l-435"></a><span class="linenos">435</span><span class="w">  </span><span class="nf">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
</div><div class="line"><a id="l-436" name="l-436"></a><span class="linenos">436</span>
</div><div class="line"><a id="l-437" name="l-437"></a><span class="linenos">437</span><span class="w">  </span><span class="kr">String</span><span class="w"> </span><span class="n">sdiResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mySDI12</span><span class="p">.</span><span class="nf">readStringUntil</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
</div><div class="line"><a id="l-438" name="l-438"></a><span class="linenos">438</span><span class="w">  </span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">trim</span><span class="p">();</span>
</div><div class="line"><a id="l-439" name="l-439"></a><span class="linenos">439</span><span class="w">  </span><span class="c1">// allccccccccmmmmmmvvvxxx...xx&lt;CR&gt;&lt;LF&gt;</span>
</div><div class="line"><a id="l-440" name="l-440"></a><span class="linenos">440</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">printCommands</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-441" name="l-441"></a><span class="linenos">441</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;&lt;&lt;&lt;&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-442" name="l-442"></a><span class="linenos">442</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">);</span>
</div><div class="line"><a id="l-443" name="l-443"></a><span class="linenos">443</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-444" name="l-444"></a><span class="linenos">444</span>
</div><div class="line"><a id="l-445" name="l-445"></a><span class="linenos">445</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Address: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-446" name="l-446"></a><span class="linenos">446</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w">  </span><span class="c1">// address</span>
</div><div class="line"><a id="l-447" name="l-447"></a><span class="linenos">447</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, SDI-12 Version: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-448" name="l-448"></a><span class="linenos">448</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">).</span><span class="n">toFloat</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span><span class="w">  </span><span class="c1">// SDI-12 version number</span>
</div><div class="line"><a id="l-449" name="l-449"></a><span class="linenos">449</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Vendor ID: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-450" name="l-450"></a><span class="linenos">450</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">));</span><span class="w">  </span><span class="c1">// vendor id</span>
</div><div class="line"><a id="l-451" name="l-451"></a><span class="linenos">451</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Sensor Model: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-452" name="l-452"></a><span class="linenos">452</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">17</span><span class="p">));</span><span class="w">  </span><span class="c1">// sensor model</span>
</div><div class="line"><a id="l-453" name="l-453"></a><span class="linenos">453</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Sensor Version: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-454" name="l-454"></a><span class="linenos">454</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">));</span><span class="w">  </span><span class="c1">// sensor version</span>
</div><div class="line"><a id="l-455" name="l-455"></a><span class="linenos">455</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Sensor ID: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-456" name="l-456"></a><span class="linenos">456</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span><span class="w">  </span><span class="c1">// sensor id</span>
</div><div class="line"><a id="l-457" name="l-457"></a><span class="linenos">457</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">();</span>
</div><div class="line"><a id="l-458" name="l-458"></a><span class="linenos">458</span>
</div><div class="line"><a id="l-459" name="l-459"></a><span class="linenos">459</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sdiResponse</span><span class="p">.</span><span class="n">length</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kr">false</span><span class="p">;</span><span class="w"> </span><span class="p">};</span>
</div><div class="line"><a id="l-460" name="l-460"></a><span class="linenos">460</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-461" name="l-461"></a><span class="linenos">461</span><span class="p">}</span>
</div><div class="line"><a id="l-462" name="l-462"></a><span class="linenos">462</span>
</div><div class="line"><a id="l-463" name="l-463"></a><span class="linenos">463</span><span class="kr">void</span><span class="w"> </span><span class="nb">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-464" name="l-464"></a><span class="linenos">464</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="n">serialBaud</span><span class="p">);</span>
</div><div class="line"><a id="l-465" name="l-465"></a><span class="linenos">465</span><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">Serial</span><span class="p">)</span>
</div><div class="line"><a id="l-466" name="l-466"></a><span class="linenos">466</span><span class="w">    </span><span class="p">;</span>
</div><div class="line"><a id="l-467" name="l-467"></a><span class="linenos">467</span>
</div><div class="line"><a id="l-468" name="l-468"></a><span class="linenos">468</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Opening SDI-12 bus on pin &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-469" name="l-469"></a><span class="linenos">469</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="kr">String</span><span class="p">(</span><span class="n">dataPin</span><span class="p">));</span>
</div><div class="line"><a id="l-470" name="l-470"></a><span class="linenos">470</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;...&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-471" name="l-471"></a><span class="linenos">471</span><span class="w">  </span><span class="n">mySDI12</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
</div><div class="line"><a id="l-472" name="l-472"></a><span class="linenos">472</span><span class="w">  </span><span class="nf">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span><span class="w">  </span><span class="c1">// allow things to settle</span>
</div><div class="line"><a id="l-473" name="l-473"></a><span class="linenos">473</span>
</div><div class="line"><a id="l-474" name="l-474"></a><span class="linenos">474</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;Timeout value: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-475" name="l-475"></a><span class="linenos">475</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">mySDI12</span><span class="p">.</span><span class="n">TIMEOUT</span><span class="p">);</span>
</div><div class="line"><a id="l-476" name="l-476"></a><span class="linenos">476</span>
</div><div class="line"><a id="l-477" name="l-477"></a><span class="linenos">477</span><span class="w">  </span><span class="c1">// Power the sensors;</span>
</div><div class="line"><a id="l-478" name="l-478"></a><span class="linenos">478</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">powerPin</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">testPowerOff</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-479" name="l-479"></a><span class="linenos">479</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;Powering up sensors with pin &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-480" name="l-480"></a><span class="linenos">480</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="kr">String</span><span class="p">(</span><span class="n">powerPin</span><span class="p">));</span>
</div><div class="line"><a id="l-481" name="l-481"></a><span class="linenos">481</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;, wait 30s...&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-482" name="l-482"></a><span class="linenos">482</span><span class="w">    </span><span class="nf">pinMode</span><span class="p">(</span><span class="n">powerPin</span><span class="p">,</span><span class="w"> </span><span class="kr">OUTPUT</span><span class="p">);</span>
</div><div class="line"><a id="l-483" name="l-483"></a><span class="linenos">483</span><span class="w">    </span><span class="nf">digitalWrite</span><span class="p">(</span><span class="n">powerPin</span><span class="p">,</span><span class="w"> </span><span class="kr">HIGH</span><span class="p">);</span>
</div><div class="line"><a id="l-484" name="l-484"></a><span class="linenos">484</span><span class="w">    </span><span class="nf">delay</span><span class="p">(</span><span class="mf">30000L</span><span class="p">);</span>
</div><div class="line"><a id="l-485" name="l-485"></a><span class="linenos">485</span><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-486" name="l-486"></a><span class="linenos">486</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;Wait 5s...&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-487" name="l-487"></a><span class="linenos">487</span><span class="w">    </span><span class="nf">delay</span><span class="p">(</span><span class="mf">5000L</span><span class="p">);</span>
</div><div class="line"><a id="l-488" name="l-488"></a><span class="linenos">488</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-489" name="l-489"></a><span class="linenos">489</span><span class="p">}</span>
</div><div class="line"><a id="l-490" name="l-490"></a><span class="linenos">490</span>
</div><div class="line"><a id="l-491" name="l-491"></a><span class="linenos">491</span><span class="kr">void</span><span class="w"> </span><span class="nb">loop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-492" name="l-492"></a><span class="linenos">492</span><span class="w">  </span><span class="kr">bool</span><span class="w"> </span><span class="n">got_good_results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">true</span><span class="p">;</span>
</div><div class="line"><a id="l-493" name="l-493"></a><span class="linenos">493</span><span class="w">  </span><span class="kr">int</span><span class="w">  </span><span class="n">checks_at_time</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-494" name="l-494"></a><span class="linenos">494</span><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">got_good_results</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">checks_at_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">25</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-495" name="l-495"></a><span class="linenos">495</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Repeat attempt &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-496" name="l-496"></a><span class="linenos">496</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">checks_at_time</span><span class="p">);</span>
</div><div class="line"><a id="l-497" name="l-497"></a><span class="linenos">497</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot; with power on warm-up time of &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-498" name="l-498"></a><span class="linenos">498</span><span class="w">    </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">power_delay</span><span class="p">);</span>
</div><div class="line"><a id="l-499" name="l-499"></a><span class="linenos">499</span>
</div><div class="line"><a id="l-500" name="l-500"></a><span class="linenos">500</span><span class="w">    </span><span class="c1">// Power down the sensors;</span>
</div><div class="line"><a id="l-501" name="l-501"></a><span class="linenos">501</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">powerPin</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">testPowerOff</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-502" name="l-502"></a><span class="linenos">502</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Powering down sensors, wait &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-503" name="l-503"></a><span class="linenos">503</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">power_off_time</span><span class="p">);</span>
</div><div class="line"><a id="l-504" name="l-504"></a><span class="linenos">504</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot; ms&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-505" name="l-505"></a><span class="linenos">505</span><span class="w">      </span><span class="nf">pinMode</span><span class="p">(</span><span class="n">powerPin</span><span class="p">,</span><span class="w"> </span><span class="kr">OUTPUT</span><span class="p">);</span>
</div><div class="line"><a id="l-506" name="l-506"></a><span class="linenos">506</span><span class="w">      </span><span class="nf">digitalWrite</span><span class="p">(</span><span class="n">powerPin</span><span class="p">,</span><span class="w"> </span><span class="kr">LOW</span><span class="p">);</span>
</div><div class="line"><a id="l-507" name="l-507"></a><span class="linenos">507</span><span class="w">      </span><span class="nf">delay</span><span class="p">(</span><span class="n">power_off_time</span><span class="p">);</span>
</div><div class="line"><a id="l-508" name="l-508"></a><span class="linenos">508</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-509" name="l-509"></a><span class="linenos">509</span>
</div><div class="line"><a id="l-510" name="l-510"></a><span class="linenos">510</span><span class="w">    </span><span class="c1">// Power up the sensors;</span>
</div><div class="line"><a id="l-511" name="l-511"></a><span class="linenos">511</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">powerPin</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">testPowerOff</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-512" name="l-512"></a><span class="linenos">512</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Powering up sensors, wait &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-513" name="l-513"></a><span class="linenos">513</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">power_delay</span><span class="p">);</span>
</div><div class="line"><a id="l-514" name="l-514"></a><span class="linenos">514</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot; ms&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-515" name="l-515"></a><span class="linenos">515</span><span class="w">      </span><span class="nf">pinMode</span><span class="p">(</span><span class="n">powerPin</span><span class="p">,</span><span class="w"> </span><span class="kr">OUTPUT</span><span class="p">);</span>
</div><div class="line"><a id="l-516" name="l-516"></a><span class="linenos">516</span><span class="w">      </span><span class="nf">digitalWrite</span><span class="p">(</span><span class="n">powerPin</span><span class="p">,</span><span class="w"> </span><span class="kr">HIGH</span><span class="p">);</span>
</div><div class="line"><a id="l-517" name="l-517"></a><span class="linenos">517</span><span class="w">      </span><span class="nf">delay</span><span class="p">(</span><span class="n">power_delay</span><span class="p">);</span>
</div><div class="line"><a id="l-518" name="l-518"></a><span class="linenos">518</span><span class="w">      </span><span class="n">mySDI12</span><span class="p">.</span><span class="n">clearBuffer</span><span class="p">();</span>
</div><div class="line"><a id="l-519" name="l-519"></a><span class="linenos">519</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-520" name="l-520"></a><span class="linenos">520</span>
</div><div class="line"><a id="l-521" name="l-521"></a><span class="linenos">521</span><span class="w">    </span><span class="c1">// checkActive(sensorAddress, true);</span>
</div><div class="line"><a id="l-522" name="l-522"></a><span class="linenos">522</span>
</div><div class="line"><a id="l-523" name="l-523"></a><span class="linenos">523</span><span class="w">    </span><span class="kr">uint32_t</span><span class="w"> </span><span class="n">this_meas_time</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">takeMeasurement</span><span class="p">(</span><span class="n">sensorAddress</span><span class="p">,</span><span class="w"> </span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="kr">true</span><span class="p">);</span>
</div><div class="line"><a id="l-524" name="l-524"></a><span class="linenos">524</span><span class="w">    </span><span class="kr">bool</span><span class="w">     </span><span class="n">this_result_good</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this_meas_time</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kr">static_cast</span><span class="o">&lt;</span><span class="kr">uint32_t</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span>
</div><div class="line"><a id="l-525" name="l-525"></a><span class="linenos">525</span>
</div><div class="line"><a id="l-526" name="l-526"></a><span class="linenos">526</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">this_result_good</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-527" name="l-527"></a><span class="linenos">527</span><span class="w">      </span><span class="n">total_meas_time</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">this_meas_time</span><span class="p">;</span>
</div><div class="line"><a id="l-528" name="l-528"></a><span class="linenos">528</span><span class="w">      </span><span class="n">total_meas_made</span><span class="o">++</span><span class="p">;</span>
</div><div class="line"><a id="l-529" name="l-529"></a><span class="linenos">529</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">this_meas_time</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max_meas_time</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">max_meas_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this_meas_time</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</div><div class="line"><a id="l-530" name="l-530"></a><span class="linenos">530</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Warm-up Time: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-531" name="l-531"></a><span class="linenos">531</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">power_delay</span><span class="p">);</span>
</div><div class="line"><a id="l-532" name="l-532"></a><span class="linenos">532</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, This measurement time: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-533" name="l-533"></a><span class="linenos">533</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">this_meas_time</span><span class="p">);</span>
</div><div class="line"><a id="l-534" name="l-534"></a><span class="linenos">534</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Mean measurement time: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-535" name="l-535"></a><span class="linenos">535</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">total_meas_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_meas_made</span><span class="p">);</span>
</div><div class="line"><a id="l-536" name="l-536"></a><span class="linenos">536</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Max measurement time: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-537" name="l-537"></a><span class="linenos">537</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">max_meas_time</span><span class="p">);</span>
</div><div class="line"><a id="l-538" name="l-538"></a><span class="linenos">538</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-539" name="l-539"></a><span class="linenos">539</span>
</div><div class="line"><a id="l-540" name="l-540"></a><span class="linenos">540</span><span class="w">    </span><span class="n">got_good_results</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="n">this_result_good</span><span class="p">;</span>
</div><div class="line"><a id="l-541" name="l-541"></a><span class="linenos">541</span><span class="w">    </span><span class="n">checks_at_time</span><span class="o">++</span><span class="p">;</span>
</div><div class="line"><a id="l-542" name="l-542"></a><span class="linenos">542</span>
</div><div class="line"><a id="l-543" name="l-543"></a><span class="linenos">543</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">got_good_results</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-544" name="l-544"></a><span class="linenos">544</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Time check failed after &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-545" name="l-545"></a><span class="linenos">545</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">checks_at_time</span><span class="p">);</span>
</div><div class="line"><a id="l-546" name="l-546"></a><span class="linenos">546</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot; reps&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-547" name="l-547"></a><span class="linenos">547</span><span class="w">      </span><span class="n">total_meas_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-548" name="l-548"></a><span class="linenos">548</span><span class="w">      </span><span class="n">total_meas_made</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-549" name="l-549"></a><span class="linenos">549</span><span class="w">      </span><span class="n">max_meas_time</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</div><div class="line"><a id="l-550" name="l-550"></a><span class="linenos">550</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-551" name="l-551"></a><span class="linenos">551</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-552" name="l-552"></a><span class="linenos">552</span>
</div><div class="line"><a id="l-553" name="l-553"></a><span class="linenos">553</span><span class="w">  </span><span class="c1">// if we got a good result 25x at this warm-up, keep testing how long the</span>
</div><div class="line"><a id="l-554" name="l-554"></a><span class="linenos">554</span><span class="w">  </span><span class="c1">// measurements take</span>
</div><div class="line"><a id="l-555" name="l-555"></a><span class="linenos">555</span><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">got_good_results</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-556" name="l-556"></a><span class="linenos">556</span><span class="w">    </span><span class="kr">uint32_t</span><span class="w"> </span><span class="n">this_meas_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">takeMeasurement</span><span class="p">(</span><span class="n">sensorAddress</span><span class="p">,</span><span class="w"> </span><span class="kr">true</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="kr">false</span><span class="p">);</span>
</div><div class="line"><a id="l-557" name="l-557"></a><span class="linenos">557</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">this_meas_time</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kr">static_cast</span><span class="o">&lt;</span><span class="kr">uint32_t</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-558" name="l-558"></a><span class="linenos">558</span><span class="w">      </span><span class="n">total_meas_time</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">this_meas_time</span><span class="p">;</span>
</div><div class="line"><a id="l-559" name="l-559"></a><span class="linenos">559</span><span class="w">      </span><span class="n">total_meas_made</span><span class="o">++</span><span class="p">;</span>
</div><div class="line"><a id="l-560" name="l-560"></a><span class="linenos">560</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">this_meas_time</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max_meas_time</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">max_meas_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this_meas_time</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</div><div class="line"><a id="l-561" name="l-561"></a><span class="linenos">561</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Warm-up Time: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-562" name="l-562"></a><span class="linenos">562</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">power_delay</span><span class="p">);</span>
</div><div class="line"><a id="l-563" name="l-563"></a><span class="linenos">563</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, This measurement time: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-564" name="l-564"></a><span class="linenos">564</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">this_meas_time</span><span class="p">);</span>
</div><div class="line"><a id="l-565" name="l-565"></a><span class="linenos">565</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Mean measurement time: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-566" name="l-566"></a><span class="linenos">566</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">total_meas_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_meas_made</span><span class="p">);</span>
</div><div class="line"><a id="l-567" name="l-567"></a><span class="linenos">567</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;, Max measurement time: &quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-568" name="l-568"></a><span class="linenos">568</span><span class="w">      </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">max_meas_time</span><span class="p">);</span>
</div><div class="line"><a id="l-569" name="l-569"></a><span class="linenos">569</span><span class="w">    </span><span class="p">}</span>
</div><div class="line"><a id="l-570" name="l-570"></a><span class="linenos">570</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-571" name="l-571"></a><span class="linenos">571</span>
</div><div class="line"><a id="l-572" name="l-572"></a><span class="linenos">572</span>
</div><div class="line"><a id="l-573" name="l-573"></a><span class="linenos">573</span><span class="w">  </span><span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;-------------------------------------------------------------------&quot;</span>
</div><div class="line"><a id="l-574" name="l-574"></a><span class="linenos">574</span><span class="w">                 </span><span class="s">&quot;------------&quot;</span><span class="p">);</span>
</div><div class="line"><a id="l-575" name="l-575"></a><span class="linenos">575</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">power_delay</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max_power_delay</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-576" name="l-576"></a><span class="linenos">576</span><span class="w">    </span><span class="n">power_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min_power_delay</span><span class="p">;</span>
</div><div class="line"><a id="l-577" name="l-577"></a><span class="linenos">577</span><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</div><div class="line"><a id="l-578" name="l-578"></a><span class="linenos">578</span><span class="w">    </span><span class="n">power_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">power_delay</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">increment_power_delay</span><span class="p">;</span>
</div><div class="line"><a id="l-579" name="l-579"></a><span class="linenos">579</span><span class="w">  </span><span class="p">}</span>
</div><div class="line"><a id="l-580" name="l-580"></a><span class="linenos">580</span><span class="p">}</span>
</div></div></div>
        <div class="m-note m-dim m-thin m-text-center"><a href="_test_commands_8ino-example.html" class="m-doc">&laquo; TestCommands.ino</a> | <a href="examples_page.html" class="m-doc">Examples using the SDI-12 Library</a> | <a href="_test_warm_up_8ino-example.html" class="m-doc">TestWarmUp.ino &raquo;</a></div>
              </article>
            </main>

          </div> <!-- gp-content -->
        </div> <!-- gp-left-column -->
      </div> <!-- gp-inner-container -->
    </div> <!-- gp-content-wrapper -->

    <div id="footer-image">
      <div class="gp-container">
        <img
          src="https://www.envirodiy.org/wp-content/uploads/2016/05/EnviroDIY_LogoMaster_Square_V5_TwoTree_Trans_notext-e1462820115833.png"
          width="99"
          height="22"
          alt=""
        />
      </div>
    </div>

    <footer id="gp-footer">
      <div id="gp-copyright">
        <div class="gp-container">
          <div id="gp-copyright-text">
            <p>
              <a href="https://stroudcenter.org/" target="_blank"
                >EnviroDIY™ is a community for do-it-yourself ideas for environmental
                science and monitoring. EnviroDIY is an initiative of
                <a
                  style="text-decoration: underline"
                  href="https://stroudcenter.org/"
                  target="_blank"
                  >Stroud Water Research Center</a
                >, which advances knowledge and stewardship of freshwater systems through
                global research, education, and watershed restoration.
              </a>
            </p>
            <p>
              All content on EnviroDIY is licensed as Creative Commons
              Attribution-ShareAlike 4.0 International (CC-BY-SA). Hardware designs on this
              website are released under the CERN Open Hardware License 1.2.
              <a style="text-decoration: underline" href="https://envirodiy.org/licenses/"
                >See all licenses.</a
              >
              <a style="text-decoration: underline" href="https://envirodiy.org/terms/"
                >Terms of Use</a
              >
              |
              <a style="text-decoration: underline" href="https://envirodiy.org/privacy/"
                >Privacy Policy</a
              >
              |
              <a style="text-decoration: underline" href="https://envirodiy.org/cookies/"
                >Cookie Policy</a
              >
              |
              <a
                style="text-decoration: underline"
                href="https://envirodiy.org/shop-policies/"
                >Shop Policies</a
              >
              |
              <a style="text-decoration: underline" href="https://envirodiy.org/contact/"
                >Contact</a
              >
            </p>
            <p>
              Created with <a href="https://doxygen.org/">Doxygen</a> 1.12.0 and <a href="https://mcss.mosra.cz/">m.css</a>.
            </p>
          </div>
        </div>
      </div>
    </footer>

    <div class="gp-clear"></div>

    </div> <!-- gp-site-wrapper -->
  </div> <!-- gp-site-wrapper -->

</body>
</html>
